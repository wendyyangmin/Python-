{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Part 1"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### a)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Read in the data\n",
    "import pandas as pd\n",
    "myDF = pd.read_csv('WA_Fn-UseC_-Telco-Customer-Churn.csv')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### b)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>customerID</th>\n",
       "      <th>gender</th>\n",
       "      <th>SeniorCitizen</th>\n",
       "      <th>Partner</th>\n",
       "      <th>Dependents</th>\n",
       "      <th>tenure</th>\n",
       "      <th>PhoneService</th>\n",
       "      <th>MultipleLines</th>\n",
       "      <th>InternetService</th>\n",
       "      <th>OnlineSecurity</th>\n",
       "      <th>...</th>\n",
       "      <th>DeviceProtection</th>\n",
       "      <th>TechSupport</th>\n",
       "      <th>StreamingTV</th>\n",
       "      <th>StreamingMovies</th>\n",
       "      <th>Contract</th>\n",
       "      <th>PaperlessBilling</th>\n",
       "      <th>PaymentMethod</th>\n",
       "      <th>MonthlyCharges</th>\n",
       "      <th>TotalCharges</th>\n",
       "      <th>Churn</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>7590-VHVEG</td>\n",
       "      <td>Female</td>\n",
       "      <td>0</td>\n",
       "      <td>Yes</td>\n",
       "      <td>No</td>\n",
       "      <td>1</td>\n",
       "      <td>No</td>\n",
       "      <td>No phone service</td>\n",
       "      <td>DSL</td>\n",
       "      <td>No</td>\n",
       "      <td>...</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>Month-to-month</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Electronic check</td>\n",
       "      <td>29.85</td>\n",
       "      <td>29.85</td>\n",
       "      <td>No</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>5575-GNVDE</td>\n",
       "      <td>Male</td>\n",
       "      <td>0</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>34</td>\n",
       "      <td>Yes</td>\n",
       "      <td>No</td>\n",
       "      <td>DSL</td>\n",
       "      <td>Yes</td>\n",
       "      <td>...</td>\n",
       "      <td>Yes</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>One year</td>\n",
       "      <td>No</td>\n",
       "      <td>Mailed check</td>\n",
       "      <td>56.95</td>\n",
       "      <td>1889.5</td>\n",
       "      <td>No</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3668-QPYBK</td>\n",
       "      <td>Male</td>\n",
       "      <td>0</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>2</td>\n",
       "      <td>Yes</td>\n",
       "      <td>No</td>\n",
       "      <td>DSL</td>\n",
       "      <td>Yes</td>\n",
       "      <td>...</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>Month-to-month</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Mailed check</td>\n",
       "      <td>53.85</td>\n",
       "      <td>108.15</td>\n",
       "      <td>Yes</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>7795-CFOCW</td>\n",
       "      <td>Male</td>\n",
       "      <td>0</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>45</td>\n",
       "      <td>No</td>\n",
       "      <td>No phone service</td>\n",
       "      <td>DSL</td>\n",
       "      <td>Yes</td>\n",
       "      <td>...</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>One year</td>\n",
       "      <td>No</td>\n",
       "      <td>Bank transfer (automatic)</td>\n",
       "      <td>42.30</td>\n",
       "      <td>1840.75</td>\n",
       "      <td>No</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>9237-HQITU</td>\n",
       "      <td>Female</td>\n",
       "      <td>0</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>2</td>\n",
       "      <td>Yes</td>\n",
       "      <td>No</td>\n",
       "      <td>Fiber optic</td>\n",
       "      <td>No</td>\n",
       "      <td>...</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>Month-to-month</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Electronic check</td>\n",
       "      <td>70.70</td>\n",
       "      <td>151.65</td>\n",
       "      <td>Yes</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 21 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   customerID  gender  SeniorCitizen Partner Dependents  tenure PhoneService  \\\n",
       "0  7590-VHVEG  Female              0     Yes         No       1           No   \n",
       "1  5575-GNVDE    Male              0      No         No      34          Yes   \n",
       "2  3668-QPYBK    Male              0      No         No       2          Yes   \n",
       "3  7795-CFOCW    Male              0      No         No      45           No   \n",
       "4  9237-HQITU  Female              0      No         No       2          Yes   \n",
       "\n",
       "      MultipleLines InternetService OnlineSecurity  ...  DeviceProtection  \\\n",
       "0  No phone service             DSL             No  ...                No   \n",
       "1                No             DSL            Yes  ...               Yes   \n",
       "2                No             DSL            Yes  ...                No   \n",
       "3  No phone service             DSL            Yes  ...               Yes   \n",
       "4                No     Fiber optic             No  ...                No   \n",
       "\n",
       "  TechSupport StreamingTV StreamingMovies        Contract PaperlessBilling  \\\n",
       "0          No          No              No  Month-to-month              Yes   \n",
       "1          No          No              No        One year               No   \n",
       "2          No          No              No  Month-to-month              Yes   \n",
       "3         Yes          No              No        One year               No   \n",
       "4          No          No              No  Month-to-month              Yes   \n",
       "\n",
       "               PaymentMethod MonthlyCharges  TotalCharges Churn  \n",
       "0           Electronic check          29.85         29.85    No  \n",
       "1               Mailed check          56.95        1889.5    No  \n",
       "2               Mailed check          53.85        108.15   Yes  \n",
       "3  Bank transfer (automatic)          42.30       1840.75    No  \n",
       "4           Electronic check          70.70        151.65   Yes  \n",
       "\n",
       "[5 rows x 21 columns]"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Show the data\n",
    "myDF.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "7043"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Check the number of rows\n",
    "len(myDF)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### c)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>customerID</th>\n",
       "      <th>gender</th>\n",
       "      <th>SeniorCitizen</th>\n",
       "      <th>Partner</th>\n",
       "      <th>Dependents</th>\n",
       "      <th>tenure</th>\n",
       "      <th>PhoneService</th>\n",
       "      <th>MultipleLines</th>\n",
       "      <th>InternetService</th>\n",
       "      <th>OnlineSecurity</th>\n",
       "      <th>...</th>\n",
       "      <th>DeviceProtection</th>\n",
       "      <th>TechSupport</th>\n",
       "      <th>StreamingTV</th>\n",
       "      <th>StreamingMovies</th>\n",
       "      <th>Contract</th>\n",
       "      <th>PaperlessBilling</th>\n",
       "      <th>PaymentMethod</th>\n",
       "      <th>MonthlyCharges</th>\n",
       "      <th>TotalCharges</th>\n",
       "      <th>Churn</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>0 rows × 21 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "Empty DataFrame\n",
       "Columns: [customerID, gender, SeniorCitizen, Partner, Dependents, tenure, PhoneService, MultipleLines, InternetService, OnlineSecurity, OnlineBackup, DeviceProtection, TechSupport, StreamingTV, StreamingMovies, Contract, PaperlessBilling, PaymentMethod, MonthlyCharges, TotalCharges, Churn]\n",
       "Index: []\n",
       "\n",
       "[0 rows x 21 columns]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "myDF[myDF.isnull().any(axis=1)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 7043 entries, 0 to 7042\n",
      "Data columns (total 21 columns):\n",
      "customerID          7043 non-null object\n",
      "gender              7043 non-null object\n",
      "SeniorCitizen       7043 non-null int64\n",
      "Partner             7043 non-null object\n",
      "Dependents          7043 non-null object\n",
      "tenure              7043 non-null int64\n",
      "PhoneService        7043 non-null object\n",
      "MultipleLines       7043 non-null object\n",
      "InternetService     7043 non-null object\n",
      "OnlineSecurity      7043 non-null object\n",
      "OnlineBackup        7043 non-null object\n",
      "DeviceProtection    7043 non-null object\n",
      "TechSupport         7043 non-null object\n",
      "StreamingTV         7043 non-null object\n",
      "StreamingMovies     7043 non-null object\n",
      "Contract            7043 non-null object\n",
      "PaperlessBilling    7043 non-null object\n",
      "PaymentMethod       7043 non-null object\n",
      "MonthlyCharges      7043 non-null float64\n",
      "TotalCharges        7043 non-null object\n",
      "Churn               7043 non-null object\n",
      "dtypes: float64(1), int64(2), object(18)\n",
      "memory usage: 1.1+ MB\n"
     ]
    }
   ],
   "source": [
    "myDF.info()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "There is no missing value or null value in this data set, then we convert all categorical data to nominal value for logistic regression using LabelEncoder"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>customerID</th>\n",
       "      <th>gender</th>\n",
       "      <th>SeniorCitizen</th>\n",
       "      <th>Partner</th>\n",
       "      <th>Dependents</th>\n",
       "      <th>tenure</th>\n",
       "      <th>PhoneService</th>\n",
       "      <th>MultipleLines</th>\n",
       "      <th>InternetService</th>\n",
       "      <th>OnlineSecurity</th>\n",
       "      <th>...</th>\n",
       "      <th>DeviceProtection</th>\n",
       "      <th>TechSupport</th>\n",
       "      <th>StreamingTV</th>\n",
       "      <th>StreamingMovies</th>\n",
       "      <th>Contract</th>\n",
       "      <th>PaperlessBilling</th>\n",
       "      <th>PaymentMethod</th>\n",
       "      <th>MonthlyCharges</th>\n",
       "      <th>TotalCharges</th>\n",
       "      <th>Churn</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>5375</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>142</td>\n",
       "      <td>2505</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>3962</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>34</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>...</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>498</td>\n",
       "      <td>1466</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2564</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>436</td>\n",
       "      <td>157</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>5535</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>45</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>...</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>266</td>\n",
       "      <td>1400</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>6511</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>729</td>\n",
       "      <td>925</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>6551</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>8</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>1274</td>\n",
       "      <td>6104</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>1002</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>22</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1075</td>\n",
       "      <td>1550</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>4770</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>10</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>140</td>\n",
       "      <td>2609</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>5604</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>28</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>1371</td>\n",
       "      <td>2646</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>4534</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>62</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>482</td>\n",
       "      <td>3022</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10 rows × 21 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   customerID  gender  SeniorCitizen  Partner  Dependents  tenure  \\\n",
       "0        5375       0              0        1           0       1   \n",
       "1        3962       1              0        0           0      34   \n",
       "2        2564       1              0        0           0       2   \n",
       "3        5535       1              0        0           0      45   \n",
       "4        6511       0              0        0           0       2   \n",
       "5        6551       0              0        0           0       8   \n",
       "6        1002       1              0        0           1      22   \n",
       "7        4770       0              0        0           0      10   \n",
       "8        5604       0              0        1           0      28   \n",
       "9        4534       1              0        0           1      62   \n",
       "\n",
       "   PhoneService  MultipleLines  InternetService  OnlineSecurity  ...    \\\n",
       "0             0              1                0               0  ...     \n",
       "1             1              0                0               2  ...     \n",
       "2             1              0                0               2  ...     \n",
       "3             0              1                0               2  ...     \n",
       "4             1              0                1               0  ...     \n",
       "5             1              2                1               0  ...     \n",
       "6             1              2                1               0  ...     \n",
       "7             0              1                0               2  ...     \n",
       "8             1              2                1               0  ...     \n",
       "9             1              0                0               2  ...     \n",
       "\n",
       "   DeviceProtection  TechSupport  StreamingTV  StreamingMovies  Contract  \\\n",
       "0                 0            0            0                0         0   \n",
       "1                 2            0            0                0         1   \n",
       "2                 0            0            0                0         0   \n",
       "3                 2            2            0                0         1   \n",
       "4                 0            0            0                0         0   \n",
       "5                 2            0            2                2         0   \n",
       "6                 0            0            2                0         0   \n",
       "7                 0            0            0                0         0   \n",
       "8                 2            2            2                2         0   \n",
       "9                 0            0            0                0         1   \n",
       "\n",
       "   PaperlessBilling  PaymentMethod  MonthlyCharges  TotalCharges  Churn  \n",
       "0                 1              2             142          2505      0  \n",
       "1                 0              3             498          1466      0  \n",
       "2                 1              3             436           157      1  \n",
       "3                 0              0             266          1400      0  \n",
       "4                 1              2             729           925      1  \n",
       "5                 1              2            1274          6104      1  \n",
       "6                 1              1            1075          1550      0  \n",
       "7                 0              3             140          2609      0  \n",
       "8                 1              2            1371          2646      1  \n",
       "9                 0              0             482          3022      0  \n",
       "\n",
       "[10 rows x 21 columns]"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from sklearn.preprocessing import LabelEncoder\n",
    "\n",
    "newdata = LabelEncoder()\n",
    "data = myDF.apply(newdata.fit_transform)\n",
    "data.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Alternatively,we can use map to convert each column\n",
    "#myDF['gender'] = myDF['gender'].map({'Male': 1, 'Female': 0})\n",
    "#myDF['Partner'] = myDF['Partner'].map({'Yes': 1, 'No': 0})\n",
    "#myDF['Dependents'] = myDF['Dependents'].map({'Yes': 1, 'No': 0})\n",
    "#myDF['PhoneService'] = myDF['PhoneService'].map({'Yes': 1, 'No': 0})\n",
    "#myDF['OnlineSecurity'] = myDF['OnlineSecurity'].map({'Yes': 1, 'No': 0,'No internet service': 0})\n",
    "#myDF['OnlineBackup'] = myDF['OnlineBackup'].map({'Yes': 1, 'No': 0,'No internet service': 0})\n",
    "#myDF['DeviceProtection'] = myDF['DeviceProtection'].map({'Yes': 1, 'No': 0,'No internet service': 0})\n",
    "#myDF['TechSupport'] = myDF['TechSupport'].map({'Yes': 1, 'No': 0,'No internet service': 0})\n",
    "#myDF['StreamingTV'] = myDF['StreamingTV'].map({'Yes': 1, 'No': 0,'No internet service': 0})\n",
    "#myDF['StreamingMovies'] = myDF['StreamingMovies'].map({'Yes': 1, 'No': 0,'No internet service': 0})\n",
    "#myDF['Churn'] = myDF['Churn'].map({'Yes': 1, 'No': 0})"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### d)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "from patsy import dmatrices\n",
    "from sklearn.linear_model import LogisticRegression\n",
    "import numpy as np"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Create matrices\n",
    "y, x = dmatrices('Churn ~ gender+Partner+Dependents+tenure+PhoneService+MultipleLines+SeniorCitizen+\\\n",
    "                       InternetService+OnlineSecurity+OnlineBackup+DeviceProtection+TechSupport+\\\n",
    "                       TechSupport+StreamingTV+StreamingMovies+Contract+PaperlessBilling+\\\n",
    "                       PaymentMethod+MonthlyCharges+TotalCharges', \n",
    "                       data,return_type= 'dataframe')\n",
    "y= np.ravel(y)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "      Intercept  gender  Partner  Dependents  tenure  PhoneService  \\\n",
      "0           1.0     0.0      1.0         0.0     1.0           0.0   \n",
      "1           1.0     1.0      0.0         0.0    34.0           1.0   \n",
      "2           1.0     1.0      0.0         0.0     2.0           1.0   \n",
      "3           1.0     1.0      0.0         0.0    45.0           0.0   \n",
      "4           1.0     0.0      0.0         0.0     2.0           1.0   \n",
      "5           1.0     0.0      0.0         0.0     8.0           1.0   \n",
      "6           1.0     1.0      0.0         1.0    22.0           1.0   \n",
      "7           1.0     0.0      0.0         0.0    10.0           0.0   \n",
      "8           1.0     0.0      1.0         0.0    28.0           1.0   \n",
      "9           1.0     1.0      0.0         1.0    62.0           1.0   \n",
      "10          1.0     1.0      1.0         1.0    13.0           1.0   \n",
      "11          1.0     1.0      0.0         0.0    16.0           1.0   \n",
      "12          1.0     1.0      1.0         0.0    58.0           1.0   \n",
      "13          1.0     1.0      0.0         0.0    49.0           1.0   \n",
      "14          1.0     1.0      0.0         0.0    25.0           1.0   \n",
      "15          1.0     0.0      1.0         1.0    69.0           1.0   \n",
      "16          1.0     0.0      0.0         0.0    52.0           1.0   \n",
      "17          1.0     1.0      0.0         1.0    71.0           1.0   \n",
      "18          1.0     0.0      1.0         1.0    10.0           1.0   \n",
      "19          1.0     0.0      0.0         0.0    21.0           1.0   \n",
      "20          1.0     1.0      0.0         0.0     1.0           0.0   \n",
      "21          1.0     1.0      1.0         0.0    12.0           1.0   \n",
      "22          1.0     1.0      0.0         0.0     1.0           1.0   \n",
      "23          1.0     0.0      1.0         0.0    58.0           1.0   \n",
      "24          1.0     1.0      1.0         1.0    49.0           1.0   \n",
      "25          1.0     0.0      0.0         0.0    30.0           1.0   \n",
      "26          1.0     1.0      1.0         1.0    47.0           1.0   \n",
      "27          1.0     1.0      1.0         1.0     1.0           0.0   \n",
      "28          1.0     1.0      1.0         0.0    72.0           1.0   \n",
      "29          1.0     0.0      0.0         1.0    17.0           1.0   \n",
      "...         ...     ...      ...         ...     ...           ...   \n",
      "7013        1.0     0.0      0.0         0.0    40.0           1.0   \n",
      "7014        1.0     1.0      0.0         0.0    41.0           1.0   \n",
      "7015        1.0     1.0      1.0         0.0    34.0           1.0   \n",
      "7016        1.0     0.0      0.0         0.0     1.0           1.0   \n",
      "7017        1.0     0.0      0.0         0.0    51.0           1.0   \n",
      "7018        1.0     1.0      1.0         1.0     1.0           1.0   \n",
      "7019        1.0     0.0      0.0         0.0    39.0           1.0   \n",
      "7020        1.0     1.0      1.0         1.0    12.0           1.0   \n",
      "7021        1.0     1.0      0.0         0.0    12.0           1.0   \n",
      "7022        1.0     1.0      0.0         0.0    72.0           1.0   \n",
      "7023        1.0     0.0      1.0         0.0    63.0           1.0   \n",
      "7024        1.0     1.0      1.0         0.0    44.0           1.0   \n",
      "7025        1.0     0.0      0.0         0.0    18.0           1.0   \n",
      "7026        1.0     0.0      0.0         0.0     9.0           1.0   \n",
      "7027        1.0     1.0      0.0         0.0    13.0           1.0   \n",
      "7028        1.0     0.0      1.0         0.0    68.0           1.0   \n",
      "7029        1.0     0.0      0.0         0.0     6.0           0.0   \n",
      "7030        1.0     0.0      0.0         0.0     2.0           1.0   \n",
      "7031        1.0     1.0      1.0         0.0    55.0           1.0   \n",
      "7032        1.0     1.0      0.0         0.0     1.0           1.0   \n",
      "7033        1.0     1.0      0.0         0.0    38.0           1.0   \n",
      "7034        1.0     0.0      0.0         0.0    67.0           1.0   \n",
      "7035        1.0     1.0      0.0         0.0    19.0           1.0   \n",
      "7036        1.0     0.0      0.0         0.0    12.0           0.0   \n",
      "7037        1.0     0.0      0.0         0.0    72.0           1.0   \n",
      "7038        1.0     1.0      1.0         1.0    24.0           1.0   \n",
      "7039        1.0     0.0      1.0         1.0    72.0           1.0   \n",
      "7040        1.0     0.0      1.0         1.0    11.0           0.0   \n",
      "7041        1.0     1.0      1.0         0.0     4.0           1.0   \n",
      "7042        1.0     1.0      0.0         0.0    66.0           1.0   \n",
      "\n",
      "      MultipleLines  SeniorCitizen  InternetService  OnlineSecurity  \\\n",
      "0               1.0            0.0              0.0             0.0   \n",
      "1               0.0            0.0              0.0             2.0   \n",
      "2               0.0            0.0              0.0             2.0   \n",
      "3               1.0            0.0              0.0             2.0   \n",
      "4               0.0            0.0              1.0             0.0   \n",
      "5               2.0            0.0              1.0             0.0   \n",
      "6               2.0            0.0              1.0             0.0   \n",
      "7               1.0            0.0              0.0             2.0   \n",
      "8               2.0            0.0              1.0             0.0   \n",
      "9               0.0            0.0              0.0             2.0   \n",
      "10              0.0            0.0              0.0             2.0   \n",
      "11              0.0            0.0              2.0             1.0   \n",
      "12              2.0            0.0              1.0             0.0   \n",
      "13              2.0            0.0              1.0             0.0   \n",
      "14              0.0            0.0              1.0             2.0   \n",
      "15              2.0            0.0              1.0             2.0   \n",
      "16              0.0            0.0              2.0             1.0   \n",
      "17              2.0            0.0              1.0             2.0   \n",
      "18              0.0            0.0              0.0             0.0   \n",
      "19              0.0            0.0              1.0             0.0   \n",
      "20              1.0            1.0              0.0             0.0   \n",
      "21              0.0            0.0              2.0             1.0   \n",
      "22              0.0            0.0              2.0             1.0   \n",
      "23              2.0            0.0              0.0             0.0   \n",
      "24              0.0            0.0              0.0             2.0   \n",
      "25              0.0            0.0              0.0             2.0   \n",
      "26              2.0            0.0              1.0             0.0   \n",
      "27              1.0            0.0              0.0             0.0   \n",
      "28              2.0            0.0              0.0             2.0   \n",
      "29              0.0            0.0              0.0             0.0   \n",
      "...             ...            ...              ...             ...   \n",
      "7013            2.0            0.0              1.0             0.0   \n",
      "7014            2.0            0.0              1.0             0.0   \n",
      "7015            0.0            1.0              1.0             0.0   \n",
      "7016            0.0            0.0              0.0             0.0   \n",
      "7017            0.0            0.0              2.0             1.0   \n",
      "7018            0.0            0.0              1.0             0.0   \n",
      "7019            0.0            0.0              2.0             1.0   \n",
      "7020            0.0            0.0              2.0             1.0   \n",
      "7021            0.0            0.0              0.0             0.0   \n",
      "7022            2.0            0.0              1.0             0.0   \n",
      "7023            2.0            1.0              1.0             0.0   \n",
      "7024            2.0            0.0              1.0             2.0   \n",
      "7025            2.0            0.0              1.0             0.0   \n",
      "7026            0.0            0.0              0.0             0.0   \n",
      "7027            0.0            0.0              0.0             0.0   \n",
      "7028            0.0            0.0              0.0             0.0   \n",
      "7029            1.0            1.0              0.0             0.0   \n",
      "7030            0.0            0.0              2.0             1.0   \n",
      "7031            2.0            1.0              0.0             2.0   \n",
      "7032            2.0            1.0              1.0             0.0   \n",
      "7033            0.0            0.0              1.0             0.0   \n",
      "7034            2.0            0.0              1.0             2.0   \n",
      "7035            0.0            0.0              1.0             0.0   \n",
      "7036            1.0            0.0              0.0             0.0   \n",
      "7037            0.0            0.0              2.0             1.0   \n",
      "7038            2.0            0.0              0.0             2.0   \n",
      "7039            2.0            0.0              1.0             0.0   \n",
      "7040            1.0            0.0              0.0             2.0   \n",
      "7041            2.0            1.0              1.0             0.0   \n",
      "7042            0.0            0.0              1.0             2.0   \n",
      "\n",
      "      OnlineBackup  DeviceProtection  TechSupport  StreamingTV  \\\n",
      "0              2.0               0.0          0.0          0.0   \n",
      "1              0.0               2.0          0.0          0.0   \n",
      "2              2.0               0.0          0.0          0.0   \n",
      "3              0.0               2.0          2.0          0.0   \n",
      "4              0.0               0.0          0.0          0.0   \n",
      "5              0.0               2.0          0.0          2.0   \n",
      "6              2.0               0.0          0.0          2.0   \n",
      "7              0.0               0.0          0.0          0.0   \n",
      "8              0.0               2.0          2.0          2.0   \n",
      "9              2.0               0.0          0.0          0.0   \n",
      "10             0.0               0.0          0.0          0.0   \n",
      "11             1.0               1.0          1.0          1.0   \n",
      "12             0.0               2.0          0.0          2.0   \n",
      "13             2.0               2.0          0.0          2.0   \n",
      "14             0.0               2.0          2.0          2.0   \n",
      "15             2.0               2.0          2.0          2.0   \n",
      "16             1.0               1.0          1.0          1.0   \n",
      "17             0.0               2.0          0.0          2.0   \n",
      "18             0.0               2.0          2.0          0.0   \n",
      "19             2.0               2.0          0.0          0.0   \n",
      "20             0.0               2.0          0.0          0.0   \n",
      "21             1.0               1.0          1.0          1.0   \n",
      "22             1.0               1.0          1.0          1.0   \n",
      "23             2.0               0.0          2.0          0.0   \n",
      "24             2.0               0.0          2.0          0.0   \n",
      "25             2.0               0.0          0.0          0.0   \n",
      "26             2.0               0.0          0.0          2.0   \n",
      "27             2.0               0.0          0.0          0.0   \n",
      "28             2.0               2.0          2.0          2.0   \n",
      "29             0.0               0.0          0.0          2.0   \n",
      "...            ...               ...          ...          ...   \n",
      "7013           2.0               2.0          0.0          2.0   \n",
      "7014           2.0               0.0          0.0          2.0   \n",
      "7015           0.0               2.0          0.0          2.0   \n",
      "7016           2.0               0.0          0.0          0.0   \n",
      "7017           1.0               1.0          1.0          1.0   \n",
      "7018           0.0               0.0          0.0          0.0   \n",
      "7019           1.0               1.0          1.0          1.0   \n",
      "7020           1.0               1.0          1.0          1.0   \n",
      "7021           0.0               0.0          2.0          2.0   \n",
      "7022           2.0               2.0          0.0          2.0   \n",
      "7023           2.0               2.0          0.0          2.0   \n",
      "7024           0.0               2.0          0.0          0.0   \n",
      "7025           0.0               2.0          2.0          0.0   \n",
      "7026           0.0               0.0          0.0          0.0   \n",
      "7027           2.0               0.0          2.0          2.0   \n",
      "7028           2.0               0.0          2.0          2.0   \n",
      "7029           0.0               0.0          0.0          2.0   \n",
      "7030           1.0               1.0          1.0          1.0   \n",
      "7031           2.0               0.0          0.0          0.0   \n",
      "7032           0.0               0.0          0.0          0.0   \n",
      "7033           0.0               0.0          0.0          0.0   \n",
      "7034           2.0               2.0          0.0          2.0   \n",
      "7035           0.0               0.0          0.0          2.0   \n",
      "7036           2.0               2.0          2.0          2.0   \n",
      "7037           1.0               1.0          1.0          1.0   \n",
      "7038           0.0               2.0          2.0          2.0   \n",
      "7039           2.0               2.0          0.0          2.0   \n",
      "7040           0.0               0.0          0.0          0.0   \n",
      "7041           0.0               0.0          0.0          0.0   \n",
      "7042           0.0               2.0          2.0          2.0   \n",
      "\n",
      "      StreamingMovies  Contract  PaperlessBilling  PaymentMethod  \\\n",
      "0                 0.0       0.0               1.0            2.0   \n",
      "1                 0.0       1.0               0.0            3.0   \n",
      "2                 0.0       0.0               1.0            3.0   \n",
      "3                 0.0       1.0               0.0            0.0   \n",
      "4                 0.0       0.0               1.0            2.0   \n",
      "5                 2.0       0.0               1.0            2.0   \n",
      "6                 0.0       0.0               1.0            1.0   \n",
      "7                 0.0       0.0               0.0            3.0   \n",
      "8                 2.0       0.0               1.0            2.0   \n",
      "9                 0.0       1.0               0.0            0.0   \n",
      "10                0.0       0.0               1.0            3.0   \n",
      "11                1.0       2.0               0.0            1.0   \n",
      "12                2.0       1.0               0.0            1.0   \n",
      "13                2.0       0.0               1.0            0.0   \n",
      "14                2.0       0.0               1.0            2.0   \n",
      "15                2.0       2.0               0.0            1.0   \n",
      "16                1.0       1.0               0.0            3.0   \n",
      "17                2.0       2.0               0.0            0.0   \n",
      "18                0.0       0.0               0.0            1.0   \n",
      "19                2.0       0.0               1.0            2.0   \n",
      "20                2.0       0.0               1.0            2.0   \n",
      "21                1.0       1.0               0.0            0.0   \n",
      "22                1.0       0.0               0.0            3.0   \n",
      "23                0.0       2.0               1.0            1.0   \n",
      "24                0.0       0.0               0.0            1.0   \n",
      "25                0.0       0.0               1.0            0.0   \n",
      "26                2.0       0.0               1.0            2.0   \n",
      "27                0.0       0.0               0.0            2.0   \n",
      "28                2.0       2.0               1.0            1.0   \n",
      "29                2.0       0.0               1.0            3.0   \n",
      "...               ...       ...               ...            ...   \n",
      "7013              0.0       0.0               1.0            0.0   \n",
      "7014              0.0       0.0               1.0            2.0   \n",
      "7015              0.0       0.0               1.0            1.0   \n",
      "7016              0.0       0.0               0.0            2.0   \n",
      "7017              1.0       2.0               0.0            0.0   \n",
      "7018              0.0       0.0               1.0            3.0   \n",
      "7019              1.0       2.0               0.0            3.0   \n",
      "7020              1.0       0.0               1.0            2.0   \n",
      "7021              0.0       1.0               1.0            2.0   \n",
      "7022              2.0       1.0               1.0            2.0   \n",
      "7023              2.0       0.0               1.0            2.0   \n",
      "7024              0.0       0.0               1.0            1.0   \n",
      "7025              2.0       0.0               1.0            0.0   \n",
      "7026              0.0       0.0               1.0            0.0   \n",
      "7027              2.0       0.0               0.0            3.0   \n",
      "7028              0.0       2.0               0.0            0.0   \n",
      "7029              2.0       0.0               1.0            2.0   \n",
      "7030              1.0       0.0               1.0            3.0   \n",
      "7031              0.0       1.0               0.0            1.0   \n",
      "7032              0.0       0.0               1.0            2.0   \n",
      "7033              0.0       0.0               1.0            1.0   \n",
      "7034              0.0       0.0               1.0            1.0   \n",
      "7035              0.0       0.0               1.0            0.0   \n",
      "7036              2.0       1.0               0.0            2.0   \n",
      "7037              1.0       2.0               1.0            0.0   \n",
      "7038              2.0       1.0               1.0            3.0   \n",
      "7039              2.0       1.0               1.0            1.0   \n",
      "7040              0.0       0.0               1.0            2.0   \n",
      "7041              0.0       0.0               1.0            3.0   \n",
      "7042              2.0       2.0               1.0            0.0   \n",
      "\n",
      "      MonthlyCharges  TotalCharges  \n",
      "0              142.0        2505.0  \n",
      "1              498.0        1466.0  \n",
      "2              436.0         157.0  \n",
      "3              266.0        1400.0  \n",
      "4              729.0         925.0  \n",
      "5             1274.0        6104.0  \n",
      "6             1075.0        1550.0  \n",
      "7              140.0        2609.0  \n",
      "8             1371.0        2646.0  \n",
      "9              482.0        3022.0  \n",
      "10             375.0        4823.0  \n",
      "11               8.0        2836.0  \n",
      "12            1288.0        4693.0  \n",
      "13            1349.0        4265.0  \n",
      "14            1385.0        2337.0  \n",
      "15            1519.0        5959.0  \n",
      "16              42.0          46.0  \n",
      "17            1409.0        5704.0  \n",
      "18             463.0        4416.0  \n",
      "19            1094.0        1433.0  \n",
      "20             237.0        3340.0  \n",
      "21              25.0        1651.0  \n",
      "22              32.0        1609.0  \n",
      "23             541.0        3041.0  \n",
      "24             535.0        2567.0  \n",
      "25             465.0         959.0  \n",
      "26            1268.0        4019.0  \n",
      "27             148.0        2592.0  \n",
      "28            1098.0        5135.0  \n",
      "29             622.0         184.0  \n",
      "...              ...           ...  \n",
      "7013          1156.0        3226.0  \n",
      "7014          1077.0        3149.0  \n",
      "7015           999.0        2481.0  \n",
      "7016           375.0        4148.0  \n",
      "7017            42.0          40.0  \n",
      "7018           728.0        5514.0  \n",
      "7019            32.0        6116.0  \n",
      "7020            13.0        2024.0  \n",
      "7021           539.0        5651.0  \n",
      "7022          1374.0        5796.0  \n",
      "7023          1346.0        5200.0  \n",
      "7024           991.0        3135.0  \n",
      "7025          1189.0        1166.0  \n",
      "7026           289.0        3448.0  \n",
      "7027           775.0        6401.0  \n",
      "7028           610.0        3680.0  \n",
      "7029           293.0        2278.0  \n",
      "7030            30.0        3338.0  \n",
      "7031           543.0        2880.0  \n",
      "7032           822.0        5776.0  \n",
      "7033           705.0        2272.0  \n",
      "7034          1335.0        5431.0  \n",
      "7035           874.0         892.0  \n",
      "7036           556.0        5741.0  \n",
      "7037            52.0         770.0  \n",
      "7038           991.0        1597.0  \n",
      "7039          1340.0        5698.0  \n",
      "7040           137.0        2994.0  \n",
      "7041           795.0        2660.0  \n",
      "7042          1388.0        5407.0  \n",
      "\n",
      "[7043 rows x 20 columns]\n"
     ]
    }
   ],
   "source": [
    "#print(X)\n",
    "print(x)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.8026409200624733"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# sklearn output\n",
    "model = LogisticRegression()\n",
    "mdl = model.fit(x,y)\n",
    "model.score(x,y)   "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Optimization terminated successfully.\n",
      "         Current function value: 0.416309\n",
      "         Iterations 7\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "Intercept          -0.428120\n",
       "gender             -0.028052\n",
       "Partner             0.014624\n",
       "Dependents         -0.178377\n",
       "tenure             -0.035131\n",
       "PhoneService       -0.937308\n",
       "MultipleLines       0.076735\n",
       "SeniorCitizen       0.242333\n",
       "InternetService     0.169902\n",
       "OnlineSecurity     -0.264077\n",
       "OnlineBackup       -0.134430\n",
       "DeviceProtection   -0.081071\n",
       "TechSupport        -0.255708\n",
       "StreamingTV        -0.008589\n",
       "StreamingMovies    -0.002852\n",
       "Contract           -0.725257\n",
       "PaperlessBilling    0.355445\n",
       "PaymentMethod       0.055581\n",
       "MonthlyCharges      0.001739\n",
       "TotalCharges        0.000059\n",
       "dtype: float64"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import statsmodels.discrete.discrete_model as sm\n",
    "logit = sm.Logit(y,x)\n",
    "logit.fit().params"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Gender, dependents, tenure,phoneservice, onlinsecurity, onlinebackup, devieprotection,techsupport streamingTV, streamingMovies,constract result in a corresponding decrease in the likelihood of customer churn. Partner, multiplelines,seniorcitizens, paperlessbilling,paymentmethod,monthly and total charges result in a increase in the likelihood of customer churn."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.2653698707936959"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y.mean()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "It seems approximately 26.5% of customers churn. This implies that 73.5% customers do not churn."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "np.random.seed(0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "4930\n",
      "2113\n"
     ]
    }
   ],
   "source": [
    "from sklearn.model_selection import train_test_split\n",
    "x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.3, random_state=0)\n",
    "print(len(x_train))\n",
    "print(len(x_test))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "LogisticRegression(C=1.0, class_weight=None, dual=False, fit_intercept=True,\n",
       "          intercept_scaling=1, max_iter=100, multi_class='ovr', n_jobs=1,\n",
       "          penalty='l2', random_state=None, solver='liblinear', tol=0.0001,\n",
       "          verbose=0, warm_start=False)"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "model2 = LogisticRegression()\n",
    "model2.fit(x_train, y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[0. 0. 0. ... 0. 0. 0.]\n"
     ]
    }
   ],
   "source": [
    "predicted = model2.predict(x_test)\n",
    "print (predicted)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[(0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 1), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (1, 1), (0, 0), (0, 0), (1, 0), (0, 0), (0, 1), (0, 0), (1, 1), (1, 1), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (1, 1), (1, 1), (0, 0), (1, 0), (0, 0), (1, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 1), (0, 0), (0, 0), (0, 0), (0, 1), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (1, 1), (0, 1), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 1), (0, 0), (0, 0), (0, 0), (0, 1), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 1), (0, 0), (1, 0), (0, 0), (0, 1), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (1, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (1, 0), (0, 1), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 1), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (1, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 1), (0, 0), (1, 0), (0, 0), (1, 1), (1, 0), (0, 1), (0, 0), (0, 0), (1, 1), (1, 1), (0, 1), (1, 0), (1, 1), (0, 0), (0, 0), (1, 1), (0, 1), (0, 1), (0, 0), (0, 0), (0, 0), (0, 1), (0, 1), (0, 0), (1, 1), (1, 1), (0, 0), (1, 0), (1, 1), (1, 1), (1, 1), (1, 1), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (1, 0), (0, 0), (1, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (1, 1), (1, 0), (1, 1), (0, 0), (0, 0), (0, 1), (0, 0), (0, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 1), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 1), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (1, 1), (0, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 1), (0, 0), (1, 1), (0, 1), (0, 0), (0, 1), (1, 1), (0, 1), (0, 0), (1, 1), (1, 0), (0, 1), (1, 1), (0, 0), (1, 0), (0, 0), (0, 0), (0, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (1, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (1, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 1), (0, 0), (0, 0), (0, 0), (0, 1), (1, 1), (1, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (1, 0), (1, 0), (0, 0), (0, 0), (1, 0), (1, 1), (0, 0), (1, 1), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (1, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (1, 0), (0, 1), (1, 1), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (1, 0), (1, 1), (0, 0), (1, 0), (1, 0), (0, 0), (1, 0), (0, 1), (1, 0), (0, 0), (0, 0), (1, 1), (0, 0), (1, 1), (0, 1), (0, 0), (0, 0), (1, 0), (0, 1), (0, 0), (0, 0), (1, 0), (0, 1), (0, 0), (0, 0), (0, 1), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (1, 0), (0, 1), (0, 0), (0, 1), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (1, 1), (1, 0), (0, 0), (0, 0), (0, 0), (0, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 1), (1, 1), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (1, 1), (1, 0), (0, 0), (1, 0), (0, 1), (1, 1), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 1), (1, 0), (0, 1), (1, 1), (1, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 1), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 1), (1, 1), (0, 1), (0, 0), (1, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (1, 1), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 1), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (1, 0), (0, 0), (0, 0), (1, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (1, 1), (1, 1), (0, 0), (0, 0), (1, 0), (1, 0), (1, 0), (0, 0), (0, 0), (1, 1), (0, 1), (0, 1), (1, 0), (0, 0), (1, 1), (1, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 1), (0, 0), (1, 1), (0, 0), (1, 1), (1, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 1), (0, 0), (1, 1), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (1, 0), (1, 1), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (1, 1), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 1), (0, 0), (0, 0), (1, 0), (1, 0), (1, 0), (1, 0), (0, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (1, 0), (1, 0), (0, 0), (0, 0), (0, 0), (1, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (1, 1), (0, 0), (1, 1), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (1, 0), (1, 1), (0, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 1), (0, 0), (1, 0), (1, 0), (0, 0), (1, 1), (1, 1), (0, 1), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 1), (0, 0), (0, 0), (0, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 1), (0, 0), (1, 0), (0, 0), (0, 0), (1, 1), (0, 0), (1, 1), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 1), (0, 0), (1, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 1), (0, 1), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 1), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (1, 0), (0, 0), (1, 0), (1, 1), (1, 0), (1, 1), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 1), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (1, 1), (0, 0), (0, 0), (0, 1), (0, 1), (0, 0), (0, 1), (0, 1), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (1, 1), (0, 1), (1, 0), (1, 1), (0, 0), (0, 0), (0, 1), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (1, 1), (1, 0), (0, 0), (1, 0), (0, 0), (1, 0), (1, 1), (1, 1), (0, 1), (1, 1), (0, 0), (0, 0), (1, 0), (1, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 1), (0, 1), (1, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 1), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 1), (1, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 1), (0, 1), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 1), (0, 1), (0, 0), (1, 1), (1, 0), (0, 0), (0, 0), (0, 1), (1, 1), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 1), (0, 0), (0, 0), (1, 0), (1, 1), (1, 1), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (1, 0), (0, 0), (1, 0), (0, 0), (0, 0), (1, 1), (1, 1), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (1, 1), (1, 0), (0, 0), (1, 1), (1, 0), (0, 1), (1, 1), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (1, 1), (1, 0), (0, 1), (0, 0), (0, 1), (1, 0), (1, 1), (1, 1), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 1), (1, 0), (0, 0), (0, 0), (1, 1), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 1), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 1), (1, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 1), (0, 0), (0, 1), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 1), (1, 1), (1, 1), (1, 0), (1, 0), (1, 0), (1, 1), (0, 1), (1, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (1, 1), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 1), (1, 1), (0, 0), (0, 0), (0, 1), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (1, 0), (0, 0), (1, 0), (0, 0), (0, 0), (1, 0), (0, 0), (1, 1), (1, 1), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 1), (0, 0), (0, 0), (0, 0), (1, 0), (1, 0), (1, 0), (0, 1), (0, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (1, 1), (1, 1), (0, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (1, 1), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (1, 1), (1, 1), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 1), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 1), (0, 0), (1, 0), (0, 1), (0, 0), (0, 0), (1, 1), (1, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (1, 1), (1, 0), (0, 0), (0, 0), (0, 1), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (1, 1), (1, 1), (0, 0), (1, 1), (0, 0), (1, 1), (0, 0), (1, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (1, 0), (0, 0), (0, 0), (0, 1), (1, 1), (1, 1), (1, 0), (0, 0), (0, 0), (0, 0), (0, 1), (0, 0), (1, 0), (1, 0), (0, 1), (1, 1), (0, 0), (0, 0), (1, 0), (0, 0), (1, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 1), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (1, 0), (1, 1), (0, 0), (0, 0), (1, 0), (1, 0), (0, 0), (0, 1), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 1), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (1, 0), (0, 1), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (1, 0), (0, 0), (1, 1), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (1, 1), (1, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 1), (0, 0), (0, 0), (1, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (1, 0), (0, 0), (0, 0), (1, 0), (0, 0), (1, 1), (0, 0), (1, 0), (1, 1), (0, 0), (0, 0), (1, 0), (1, 1), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (1, 1), (0, 1), (1, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 1), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (1, 1), (0, 0), (0, 0), (0, 0), (1, 1), (0, 1), (1, 0), (0, 0), (0, 0), (1, 0), (0, 1), (0, 1), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (1, 1), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 1), (1, 1), (0, 1), (1, 0), (0, 0), (0, 0), (1, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (1, 1), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (1, 1), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 1), (0, 0), (0, 0), (0, 0), (1, 1), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (1, 1), (1, 1), (0, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 1), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 1), (1, 1), (0, 1), (1, 1), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 1), (0, 0), (1, 1), (0, 0), (0, 0), (1, 1), (1, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 1), (1, 1), (0, 1), (1, 0), (1, 1), (1, 1), (1, 1), (1, 1), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 1), (1, 0), (0, 1), (0, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (1, 1), (0, 0), (0, 0), (0, 1), (0, 0), (0, 0), (0, 0), (0, 1), (1, 1), (1, 1), (0, 0), (1, 1), (0, 1), (1, 1), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (1, 0), (1, 0), (1, 0), (0, 0), (0, 0), (0, 0), (1, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (1, 1), (1, 0), (0, 0), (0, 0), (1, 0), (0, 1), (0, 0), (0, 0), (1, 0), (0, 0), (1, 1), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 1), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (1, 0), (0, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (1, 0), (1, 1), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 1), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 1), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (1, 0), (0, 0), (0, 0), (1, 1), (0, 0), (1, 0), (0, 0), (1, 1), (0, 1), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (1, 1), (1, 1), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (1, 1), (0, 1), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (1, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 1), (0, 0), (1, 1), (1, 0), (0, 0), (0, 0), (0, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (1, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (1, 1), (0, 0), (1, 0), (1, 1), (1, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (1, 1), (0, 0), (0, 0), (0, 1), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (1, 1), (1, 0), (0, 0), (1, 1), (0, 0), (1, 1), (0, 1), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (1, 1), (0, 0), (1, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (1, 0), (0, 0), (0, 0), (1, 1), (0, 0), (1, 1), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 1), (1, 0), (0, 0), (1, 1), (0, 0), (0, 1), (0, 0), (1, 1), (0, 0), (1, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 1), (0, 0), (0, 0), (0, 1), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (1, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (0, 0), (1, 0), (0, 0), (0, 0), (0, 1), (0, 0), (0, 0), (0, 0), (0, 0), (1, 1), (0, 0), (0, 0), (0, 0), (0, 0)]\n"
     ]
    }
   ],
   "source": [
    "myList = []\n",
    "for i in range(len(predicted)):\n",
    "    myList.append((int(y_test[i]),int(predicted[i])))\n",
    "print(myList)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2113\n"
     ]
    }
   ],
   "source": [
    "# generate class probabilities\n",
    "probs = model2.predict_proba(x_test)\n",
    "print (len(probs))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### e)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.7983909133932797\n",
      "0.8325277043631474\n"
     ]
    }
   ],
   "source": [
    "# generate evaluation metrics\n",
    "from sklearn import metrics\n",
    "print (metrics.accuracy_score(y_test, predicted))\n",
    "print (metrics.roc_auc_score(y_test, probs[:, 1]))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[[1402  158]\n",
      " [ 268  285]]\n",
      "-----------------\n",
      "             precision    recall  f1-score   support\n",
      "\n",
      "        0.0       0.84      0.90      0.87      1560\n",
      "        1.0       0.64      0.52      0.57       553\n",
      "\n",
      "avg / total       0.79      0.80      0.79      2113\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print (metrics.confusion_matrix(y_test, predicted))\n",
    "print(\"-----------------\")\n",
    "print (metrics.classification_report(y_test, predicted))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### f) 10-fold cross validation"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[0.79432624 0.80851064 0.80283688 0.81985816 0.78551136 0.78835227\n",
      " 0.80965909 0.78835227 0.80113636 0.80938834]\n",
      "0.8007931614234106\n"
     ]
    }
   ],
   "source": [
    "# evaluate the model using 10-fold cross-validation\n",
    "from sklearn.model_selection import cross_val_score\n",
    "scores = cross_val_score(LogisticRegression(), x, y, scoring='accuracy', cv=10)\n",
    "print (scores)\n",
    "print (scores.mean())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The overall accuracy is 80%. if repeat previous 10 times manually,this will repeat 10 times automatically "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Part B"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### a)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {
    "scrolled": false
   },
   "outputs": [],
   "source": [
    "train = pd.read_csv('Train_rev1.csv')\n",
    "test = pd.read_csv('Test_rev1.csv')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### b)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Id</th>\n",
       "      <th>Title</th>\n",
       "      <th>FullDescription</th>\n",
       "      <th>LocationRaw</th>\n",
       "      <th>LocationNormalized</th>\n",
       "      <th>ContractType</th>\n",
       "      <th>ContractTime</th>\n",
       "      <th>Company</th>\n",
       "      <th>Category</th>\n",
       "      <th>SalaryRaw</th>\n",
       "      <th>SalaryNormalized</th>\n",
       "      <th>SourceName</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>12612628</td>\n",
       "      <td>Engineering Systems Analyst</td>\n",
       "      <td>Engineering Systems Analyst Dorking Surrey Sal...</td>\n",
       "      <td>Dorking, Surrey, Surrey</td>\n",
       "      <td>Dorking</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>Gregory Martin International</td>\n",
       "      <td>Engineering Jobs</td>\n",
       "      <td>20000 - 30000/annum 20-30K</td>\n",
       "      <td>25000</td>\n",
       "      <td>cv-library.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>12612830</td>\n",
       "      <td>Stress Engineer Glasgow</td>\n",
       "      <td>Stress Engineer Glasgow Salary **** to **** We...</td>\n",
       "      <td>Glasgow, Scotland, Scotland</td>\n",
       "      <td>Glasgow</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>Gregory Martin International</td>\n",
       "      <td>Engineering Jobs</td>\n",
       "      <td>25000 - 35000/annum 25-35K</td>\n",
       "      <td>30000</td>\n",
       "      <td>cv-library.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>12612844</td>\n",
       "      <td>Modelling and simulation analyst</td>\n",
       "      <td>Mathematical Modeller / Simulation Analyst / O...</td>\n",
       "      <td>Hampshire, South East, South East</td>\n",
       "      <td>Hampshire</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>Gregory Martin International</td>\n",
       "      <td>Engineering Jobs</td>\n",
       "      <td>20000 - 40000/annum 20-40K</td>\n",
       "      <td>30000</td>\n",
       "      <td>cv-library.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>12613049</td>\n",
       "      <td>Engineering Systems Analyst / Mathematical Mod...</td>\n",
       "      <td>Engineering Systems Analyst / Mathematical Mod...</td>\n",
       "      <td>Surrey, South East, South East</td>\n",
       "      <td>Surrey</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>Gregory Martin International</td>\n",
       "      <td>Engineering Jobs</td>\n",
       "      <td>25000 - 30000/annum 25K-30K negotiable</td>\n",
       "      <td>27500</td>\n",
       "      <td>cv-library.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>12613647</td>\n",
       "      <td>Pioneer, Miser Engineering Systems Analyst</td>\n",
       "      <td>Pioneer, Miser  Engineering Systems Analyst Do...</td>\n",
       "      <td>Surrey, South East, South East</td>\n",
       "      <td>Surrey</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>Gregory Martin International</td>\n",
       "      <td>Engineering Jobs</td>\n",
       "      <td>20000 - 30000/annum 20-30K</td>\n",
       "      <td>25000</td>\n",
       "      <td>cv-library.co.uk</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         Id                                              Title  \\\n",
       "0  12612628                        Engineering Systems Analyst   \n",
       "1  12612830                            Stress Engineer Glasgow   \n",
       "2  12612844                   Modelling and simulation analyst   \n",
       "3  12613049  Engineering Systems Analyst / Mathematical Mod...   \n",
       "4  12613647         Pioneer, Miser Engineering Systems Analyst   \n",
       "\n",
       "                                     FullDescription  \\\n",
       "0  Engineering Systems Analyst Dorking Surrey Sal...   \n",
       "1  Stress Engineer Glasgow Salary **** to **** We...   \n",
       "2  Mathematical Modeller / Simulation Analyst / O...   \n",
       "3  Engineering Systems Analyst / Mathematical Mod...   \n",
       "4  Pioneer, Miser  Engineering Systems Analyst Do...   \n",
       "\n",
       "                         LocationRaw LocationNormalized ContractType  \\\n",
       "0            Dorking, Surrey, Surrey            Dorking          NaN   \n",
       "1        Glasgow, Scotland, Scotland            Glasgow          NaN   \n",
       "2  Hampshire, South East, South East          Hampshire          NaN   \n",
       "3     Surrey, South East, South East             Surrey          NaN   \n",
       "4     Surrey, South East, South East             Surrey          NaN   \n",
       "\n",
       "  ContractTime                       Company          Category  \\\n",
       "0    permanent  Gregory Martin International  Engineering Jobs   \n",
       "1    permanent  Gregory Martin International  Engineering Jobs   \n",
       "2    permanent  Gregory Martin International  Engineering Jobs   \n",
       "3    permanent  Gregory Martin International  Engineering Jobs   \n",
       "4    permanent  Gregory Martin International  Engineering Jobs   \n",
       "\n",
       "                                SalaryRaw  SalaryNormalized        SourceName  \n",
       "0              20000 - 30000/annum 20-30K             25000  cv-library.co.uk  \n",
       "1              25000 - 35000/annum 25-35K             30000  cv-library.co.uk  \n",
       "2              20000 - 40000/annum 20-40K             30000  cv-library.co.uk  \n",
       "3  25000 - 30000/annum 25K-30K negotiable             27500  cv-library.co.uk  \n",
       "4              20000 - 30000/annum 20-30K             25000  cv-library.co.uk  "
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Id</th>\n",
       "      <th>Title</th>\n",
       "      <th>FullDescription</th>\n",
       "      <th>LocationRaw</th>\n",
       "      <th>LocationNormalized</th>\n",
       "      <th>ContractType</th>\n",
       "      <th>ContractTime</th>\n",
       "      <th>Company</th>\n",
       "      <th>Category</th>\n",
       "      <th>SourceName</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>11888454</td>\n",
       "      <td>Business Development Manager</td>\n",
       "      <td>The Company: Our client is a national training...</td>\n",
       "      <td>Tyne Wear, North East</td>\n",
       "      <td>Newcastle Upon Tyne</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>Asset Appointments</td>\n",
       "      <td>Teaching Jobs</td>\n",
       "      <td>cv-library.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>11988350</td>\n",
       "      <td>Internal Account Manager</td>\n",
       "      <td>The Company: Founded in **** our client is a U...</td>\n",
       "      <td>Tyne and Wear, North East</td>\n",
       "      <td>Newcastle Upon Tyne</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>Asset Appointments</td>\n",
       "      <td>Consultancy Jobs</td>\n",
       "      <td>cv-library.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>12612558</td>\n",
       "      <td>Engineering Systems Analysts</td>\n",
       "      <td>Engineering Systems Analysts Surrey ****K Loca...</td>\n",
       "      <td>Surrey, South East, South East</td>\n",
       "      <td>Surrey</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>Gregory Martin International</td>\n",
       "      <td>Engineering Jobs</td>\n",
       "      <td>cv-library.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>12613014</td>\n",
       "      <td>CIS Systems Engineering Consultant</td>\n",
       "      <td>CIS Systems Engineering Consultant Bristol  So...</td>\n",
       "      <td>Bristol, South West, South West</td>\n",
       "      <td>Bristol</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>Gregory Martin International</td>\n",
       "      <td>Engineering Jobs</td>\n",
       "      <td>cv-library.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>22454872</td>\n",
       "      <td>CNC Miller / Programmer Fanac</td>\n",
       "      <td>CNC Miller / Programmer Fanac Fleet, Hampshire...</td>\n",
       "      <td>Fleet, Hampshire</td>\n",
       "      <td>Fleet</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>Gregory Martin International</td>\n",
       "      <td>Manufacturing Jobs</td>\n",
       "      <td>cv-library.co.uk</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         Id                               Title  \\\n",
       "0  11888454        Business Development Manager   \n",
       "1  11988350            Internal Account Manager   \n",
       "2  12612558        Engineering Systems Analysts   \n",
       "3  12613014  CIS Systems Engineering Consultant   \n",
       "4  22454872       CNC Miller / Programmer Fanac   \n",
       "\n",
       "                                     FullDescription  \\\n",
       "0  The Company: Our client is a national training...   \n",
       "1  The Company: Founded in **** our client is a U...   \n",
       "2  Engineering Systems Analysts Surrey ****K Loca...   \n",
       "3  CIS Systems Engineering Consultant Bristol  So...   \n",
       "4  CNC Miller / Programmer Fanac Fleet, Hampshire...   \n",
       "\n",
       "                       LocationRaw   LocationNormalized ContractType  \\\n",
       "0            Tyne Wear, North East  Newcastle Upon Tyne          NaN   \n",
       "1        Tyne and Wear, North East  Newcastle Upon Tyne          NaN   \n",
       "2   Surrey, South East, South East               Surrey          NaN   \n",
       "3  Bristol, South West, South West              Bristol          NaN   \n",
       "4                 Fleet, Hampshire                Fleet          NaN   \n",
       "\n",
       "  ContractTime                       Company            Category  \\\n",
       "0    permanent            Asset Appointments       Teaching Jobs   \n",
       "1    permanent            Asset Appointments    Consultancy Jobs   \n",
       "2    permanent  Gregory Martin International    Engineering Jobs   \n",
       "3    permanent  Gregory Martin International    Engineering Jobs   \n",
       "4    permanent  Gregory Martin International  Manufacturing Jobs   \n",
       "\n",
       "         SourceName  \n",
       "0  cv-library.co.uk  \n",
       "1  cv-library.co.uk  \n",
       "2  cv-library.co.uk  \n",
       "3  cv-library.co.uk  \n",
       "4  cv-library.co.uk  "
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "test.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 244768 entries, 0 to 244767\n",
      "Data columns (total 12 columns):\n",
      "Id                    244768 non-null int64\n",
      "Title                 244767 non-null object\n",
      "FullDescription       244768 non-null object\n",
      "LocationRaw           244768 non-null object\n",
      "LocationNormalized    244768 non-null object\n",
      "ContractType          65442 non-null object\n",
      "ContractTime          180863 non-null object\n",
      "Company               212338 non-null object\n",
      "Category              244768 non-null object\n",
      "SalaryRaw             244768 non-null object\n",
      "SalaryNormalized      244768 non-null int64\n",
      "SourceName            244767 non-null object\n",
      "dtypes: int64(2), object(10)\n",
      "memory usage: 22.4+ MB\n"
     ]
    }
   ],
   "source": [
    "train.info(verbose=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 122463 entries, 0 to 122462\n",
      "Data columns (total 10 columns):\n",
      "Id                    122463 non-null int64\n",
      "Title                 122463 non-null object\n",
      "FullDescription       122463 non-null object\n",
      "LocationRaw           122463 non-null object\n",
      "LocationNormalized    122463 non-null object\n",
      "ContractType          33013 non-null object\n",
      "ContractTime          90702 non-null object\n",
      "Company               106202 non-null object\n",
      "Category              122463 non-null object\n",
      "SourceName            122463 non-null object\n",
      "dtypes: int64(1), object(9)\n",
      "memory usage: 9.3+ MB\n"
     ]
    }
   ],
   "source": [
    "test.info(verbose=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Id</th>\n",
       "      <th>Title</th>\n",
       "      <th>FullDescription</th>\n",
       "      <th>LocationRaw</th>\n",
       "      <th>LocationNormalized</th>\n",
       "      <th>ContractType</th>\n",
       "      <th>ContractTime</th>\n",
       "      <th>Company</th>\n",
       "      <th>Category</th>\n",
       "      <th>SalaryRaw</th>\n",
       "      <th>SalaryNormalized</th>\n",
       "      <th>SourceName</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>12612628</td>\n",
       "      <td>Engineering Systems Analyst</td>\n",
       "      <td>Engineering Systems Analyst Dorking Surrey Sal...</td>\n",
       "      <td>Dorking, Surrey, Surrey</td>\n",
       "      <td>Dorking</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>Gregory Martin International</td>\n",
       "      <td>Engineering Jobs</td>\n",
       "      <td>20000 - 30000/annum 20-30K</td>\n",
       "      <td>25000</td>\n",
       "      <td>cv-library.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>12612830</td>\n",
       "      <td>Stress Engineer Glasgow</td>\n",
       "      <td>Stress Engineer Glasgow Salary **** to **** We...</td>\n",
       "      <td>Glasgow, Scotland, Scotland</td>\n",
       "      <td>Glasgow</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>Gregory Martin International</td>\n",
       "      <td>Engineering Jobs</td>\n",
       "      <td>25000 - 35000/annum 25-35K</td>\n",
       "      <td>30000</td>\n",
       "      <td>cv-library.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>12612844</td>\n",
       "      <td>Modelling and simulation analyst</td>\n",
       "      <td>Mathematical Modeller / Simulation Analyst / O...</td>\n",
       "      <td>Hampshire, South East, South East</td>\n",
       "      <td>Hampshire</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>Gregory Martin International</td>\n",
       "      <td>Engineering Jobs</td>\n",
       "      <td>20000 - 40000/annum 20-40K</td>\n",
       "      <td>30000</td>\n",
       "      <td>cv-library.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>12613049</td>\n",
       "      <td>Engineering Systems Analyst / Mathematical Mod...</td>\n",
       "      <td>Engineering Systems Analyst / Mathematical Mod...</td>\n",
       "      <td>Surrey, South East, South East</td>\n",
       "      <td>Surrey</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>Gregory Martin International</td>\n",
       "      <td>Engineering Jobs</td>\n",
       "      <td>25000 - 30000/annum 25K-30K negotiable</td>\n",
       "      <td>27500</td>\n",
       "      <td>cv-library.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>12613647</td>\n",
       "      <td>Pioneer, Miser Engineering Systems Analyst</td>\n",
       "      <td>Pioneer, Miser  Engineering Systems Analyst Do...</td>\n",
       "      <td>Surrey, South East, South East</td>\n",
       "      <td>Surrey</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>Gregory Martin International</td>\n",
       "      <td>Engineering Jobs</td>\n",
       "      <td>20000 - 30000/annum 20-30K</td>\n",
       "      <td>25000</td>\n",
       "      <td>cv-library.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>13179816</td>\n",
       "      <td>Engineering Systems Analyst Water Industry</td>\n",
       "      <td>Engineering Systems Analyst Water Industry Loc...</td>\n",
       "      <td>Dorking, Surrey, Surrey, Surrey</td>\n",
       "      <td>Dorking</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>Gregory Martin International</td>\n",
       "      <td>Engineering Jobs</td>\n",
       "      <td>20000 - 30000/annum 20K to 30K</td>\n",
       "      <td>25000</td>\n",
       "      <td>cv-library.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>14131336</td>\n",
       "      <td>Senior Subsea Pipeline Integrity Engineer</td>\n",
       "      <td>A globally renowned engineering and training c...</td>\n",
       "      <td>Aberdeen, Borders</td>\n",
       "      <td>UK</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>Indigo 21 Ltd</td>\n",
       "      <td>Engineering Jobs</td>\n",
       "      <td>50000 - 100000/annum</td>\n",
       "      <td>75000</td>\n",
       "      <td>cv-library.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>14663196</td>\n",
       "      <td>RECRUITMENT CONSULTANT  INDUSTRIAL / COMMERCIA...</td>\n",
       "      <td>THIS IS A LIVE VACANCY NOT A GENERIC ADVERTISE...</td>\n",
       "      <td>MANCHESTER, Greater Manchester</td>\n",
       "      <td>Manchester</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>Code Blue Recruitment</td>\n",
       "      <td>HR &amp; Recruitment Jobs</td>\n",
       "      <td>18000 - 26000/annum TO 26K BASIC + COMM + BENS</td>\n",
       "      <td>22000</td>\n",
       "      <td>cv-library.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>14663197</td>\n",
       "      <td>RECRUITMENT CONSULTANT  CONSTRUCTION / TECHNIC...</td>\n",
       "      <td>This is an exceptional opportunity to join a c...</td>\n",
       "      <td>LEEDS, West Yorkshire</td>\n",
       "      <td>Leeds</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>Code Blue Recruitment</td>\n",
       "      <td>HR &amp; Recruitment Jobs</td>\n",
       "      <td>18000 - 28000/annum 18 - 28K BASIC + COMM + BENS</td>\n",
       "      <td>23000</td>\n",
       "      <td>cv-library.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>15395797</td>\n",
       "      <td>Subsea Cables Engineer</td>\n",
       "      <td>A subsea engineering company is looking for an...</td>\n",
       "      <td>Aberdeen, UK</td>\n",
       "      <td>Aberdeen</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>Indigo 21 Ltd</td>\n",
       "      <td>Engineering Jobs</td>\n",
       "      <td>70000 - 100000/annum</td>\n",
       "      <td>85000</td>\n",
       "      <td>cv-library.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>19047429</td>\n",
       "      <td>Trainee Mortgage Advisor  East Midlands</td>\n",
       "      <td>Are you a successful, results driven person? A...</td>\n",
       "      <td>East Midlands</td>\n",
       "      <td>East Midlands</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>Brite Recruitment</td>\n",
       "      <td>Accounting &amp; Finance Jobs</td>\n",
       "      <td>17000 - 25000/annum 17k - 20k OTE 25k</td>\n",
       "      <td>21000</td>\n",
       "      <td>cv-library.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>20199757</td>\n",
       "      <td>PROJECT ENGINEER, PHARMACEUTICAL</td>\n",
       "      <td>PROJECT ENGINEER PHAMACEUTICAL, c****  Excelle...</td>\n",
       "      <td>Witney, Oxfordshire</td>\n",
       "      <td>Witney</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>MatchBox Recruiting Ltd</td>\n",
       "      <td>Healthcare &amp; Nursing Jobs</td>\n",
       "      <td>35000 - 40000/annum c40000 + Excellent Benefits</td>\n",
       "      <td>37500</td>\n",
       "      <td>cv-library.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>20638787</td>\n",
       "      <td>Principal Composite Stress Engineer</td>\n",
       "      <td>Aerospace Senior Composite Structures Engineer...</td>\n",
       "      <td>Avon, South West</td>\n",
       "      <td>Avon</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>Gregory Martin International</td>\n",
       "      <td>Other/General Jobs</td>\n",
       "      <td>40000 - 50000/annum 40K-50K</td>\n",
       "      <td>45000</td>\n",
       "      <td>cv-library.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>20638788</td>\n",
       "      <td>Senior Fatigue Damage Tolerance Engineer</td>\n",
       "      <td>Senior Fatigue Static stress (metallic or comp...</td>\n",
       "      <td>Avon, South West</td>\n",
       "      <td>Avon</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>Gregory Martin International</td>\n",
       "      <td>Other/General Jobs</td>\n",
       "      <td>35000 - 45000/annum 35K-45K</td>\n",
       "      <td>40000</td>\n",
       "      <td>cv-library.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>20797143</td>\n",
       "      <td>Chef de Partie  Award Winning Restaurant  Exce...</td>\n",
       "      <td>A well respected restaurant located in the Der...</td>\n",
       "      <td>Derby Derbyshire East Midlands</td>\n",
       "      <td>Derby</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Chef Results</td>\n",
       "      <td>Hospitality &amp; Catering Jobs</td>\n",
       "      <td>Upto 16,000 per annum + Tips (IRO 3K Per Annum)</td>\n",
       "      <td>16000</td>\n",
       "      <td>caterer.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>22579462</td>\n",
       "      <td>Quality Engineer</td>\n",
       "      <td>Our client are a leading supplier of precision...</td>\n",
       "      <td>Gateshead, Tyne and Wear</td>\n",
       "      <td>Gateshead</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>Asset Appointments</td>\n",
       "      <td>Engineering Jobs</td>\n",
       "      <td>22000/annum</td>\n",
       "      <td>22000</td>\n",
       "      <td>cv-library.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>22581547</td>\n",
       "      <td>Principal Controls Engineer</td>\n",
       "      <td>A leading Subsea Engineering Company require a...</td>\n",
       "      <td>Kent, South East</td>\n",
       "      <td>Kent</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>Indigo 21 Ltd</td>\n",
       "      <td>Engineering Jobs</td>\n",
       "      <td>70000 - 100000/annum</td>\n",
       "      <td>85000</td>\n",
       "      <td>cv-library.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>22933091</td>\n",
       "      <td>Chef de Partie  Award Winning Dining  Live In ...</td>\n",
       "      <td>A popular hotel located in Norfolk which is a ...</td>\n",
       "      <td>Norfolk East Anglia</td>\n",
       "      <td>UK</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Chef Results</td>\n",
       "      <td>Hospitality &amp; Catering Jobs</td>\n",
       "      <td>18,000 per annum + Tips (IRO 120 Per Month)</td>\n",
       "      <td>18000</td>\n",
       "      <td>caterer.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>23528672</td>\n",
       "      <td>Senior Fatigue and Damage Tolerance Engineer</td>\n",
       "      <td>Senior Fatigue Static stress (metallic or comp...</td>\n",
       "      <td>Avon, South West</td>\n",
       "      <td>Avon</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>Gregory Martin International</td>\n",
       "      <td>Engineering Jobs</td>\n",
       "      <td>34000 - 45000/annum to 45K</td>\n",
       "      <td>39500</td>\n",
       "      <td>cv-library.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>23529949</td>\n",
       "      <td>C I Design Engineer</td>\n",
       "      <td>We are currently recruiting on behalf of our c...</td>\n",
       "      <td>Wolverhampton, West Midlands</td>\n",
       "      <td>Wolverhampton</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>Rullion Engineering Ltd</td>\n",
       "      <td>Engineering Jobs</td>\n",
       "      <td>33000 - 34000/annum + benefits</td>\n",
       "      <td>33500</td>\n",
       "      <td>cv-library.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>23530231</td>\n",
       "      <td>Lead Engineers (Stress)</td>\n",
       "      <td>Lead Engineers (Stress) Our client provide hig...</td>\n",
       "      <td>Bristol, Avon, South West, Avon</td>\n",
       "      <td>UK</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>Gregory Martin International</td>\n",
       "      <td>Engineering Jobs</td>\n",
       "      <td>34000 - 45000/annum</td>\n",
       "      <td>39500</td>\n",
       "      <td>cv-library.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>24104334</td>\n",
       "      <td>Relief Chef de Partie  Croydon, Surrey  Live in</td>\n",
       "      <td>HOTEL AND CONFERENCE VENUE CHAIN  RELIEF CHEF...</td>\n",
       "      <td>South Croydon Surrey South East</td>\n",
       "      <td>UK</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Towngate Personnel</td>\n",
       "      <td>Hospitality &amp; Catering Jobs</td>\n",
       "      <td>Upto 9 per hour</td>\n",
       "      <td>17280</td>\n",
       "      <td>caterer.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>24835524</td>\n",
       "      <td>Senior Control and Instrumentation Engineer</td>\n",
       "      <td>Senior Control and Instrumentation Engineer . ...</td>\n",
       "      <td>Berkshire, South East</td>\n",
       "      <td>Berkshire</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>Gregory Martin International</td>\n",
       "      <td>Engineering Jobs</td>\n",
       "      <td>36000 - 47000/annum 36K-47K</td>\n",
       "      <td>41500</td>\n",
       "      <td>cv-library.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>24835548</td>\n",
       "      <td>Control and Instrumentation Engineer</td>\n",
       "      <td>Control and Instrumentation Engineer / C Readi...</td>\n",
       "      <td>Berkshire, South East</td>\n",
       "      <td>Berkshire</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>Gregory Martin International</td>\n",
       "      <td>Engineering Jobs</td>\n",
       "      <td>28000 - 35000/annum 28K-35K</td>\n",
       "      <td>31500</td>\n",
       "      <td>cv-library.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>24854800</td>\n",
       "      <td>Electrical / ICA Engineer</td>\n",
       "      <td>Electrical / ICA Engineer Industry: Environmen...</td>\n",
       "      <td>Surrey, South East</td>\n",
       "      <td>Surrey</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>Gregory Martin International</td>\n",
       "      <td>Engineering Jobs</td>\n",
       "      <td>28000 - 37000/annum 28,000 to 37,000</td>\n",
       "      <td>32500</td>\n",
       "      <td>cv-library.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>25337172</td>\n",
       "      <td>Pastry Chef for **** red star **** rosette hot...</td>\n",
       "      <td>Pastry Chef for **** red star **** rosette hot...</td>\n",
       "      <td>North East</td>\n",
       "      <td>North East England</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Clear Selection</td>\n",
       "      <td>Hospitality &amp; Catering Jobs</td>\n",
       "      <td>24000 per annum</td>\n",
       "      <td>24000</td>\n",
       "      <td>caterer.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>25434785</td>\n",
       "      <td>Senior Process Engineer</td>\n",
       "      <td>Senior Process Engineer We are seeking applica...</td>\n",
       "      <td>Berkshire, South East</td>\n",
       "      <td>Berkshire</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>Gregory Martin International</td>\n",
       "      <td>Engineering Jobs</td>\n",
       "      <td>36000 - 47000/annum 36-47K</td>\n",
       "      <td>41500</td>\n",
       "      <td>cv-library.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>25452606</td>\n",
       "      <td>CHEF DE PARTIE POSITION IN **** ROSETTE HOTEL ...</td>\n",
       "      <td>CHEF DE PARTIE POSITION IN **** ROSETTE HOTEL ...</td>\n",
       "      <td>North Yorkshire Yorkshire</td>\n",
       "      <td>North Yorkshire</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Clear Selection</td>\n",
       "      <td>Hospitality &amp; Catering Jobs</td>\n",
       "      <td>16000 per annum + Live In</td>\n",
       "      <td>16000</td>\n",
       "      <td>caterer.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>25452680</td>\n",
       "      <td>Senior Sous Chef for **** rosette kitchen, up ...</td>\n",
       "      <td>Senior Sous Chef for **** rosette kitchen, up ...</td>\n",
       "      <td>North East</td>\n",
       "      <td>North East England</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Clear Selection</td>\n",
       "      <td>Hospitality &amp; Catering Jobs</td>\n",
       "      <td>26000 per annum</td>\n",
       "      <td>26000</td>\n",
       "      <td>caterer.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>25556432</td>\n",
       "      <td>General Manager  Funky, Cool Restaurant Concep...</td>\n",
       "      <td>Senior General Manager – Funky, Cool, Casual R...</td>\n",
       "      <td>West London London South East</td>\n",
       "      <td>East Sheen</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Bee Recruitment London Ltd</td>\n",
       "      <td>Hospitality &amp; Catering Jobs</td>\n",
       "      <td>From 28,000 to 35,000 per annum</td>\n",
       "      <td>31500</td>\n",
       "      <td>caterer.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>244731</th>\n",
       "      <td>72703369</td>\n",
       "      <td>Senior Practitioner Children's Services</td>\n",
       "      <td>Senior Practitioner Children s Social Care An ...</td>\n",
       "      <td>London</td>\n",
       "      <td>London</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Other/General Jobs</td>\n",
       "      <td>33,510 - 39,789</td>\n",
       "      <td>36649</td>\n",
       "      <td>hays.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>244732</th>\n",
       "      <td>72703370</td>\n",
       "      <td>Housing Manager</td>\n",
       "      <td>Housing Manager Coordinating, influencing and ...</td>\n",
       "      <td>Paignton</td>\n",
       "      <td>Paignton</td>\n",
       "      <td>NaN</td>\n",
       "      <td>contract</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Other/General Jobs</td>\n",
       "      <td>16.50 per hour depending on skills and experience</td>\n",
       "      <td>31680</td>\n",
       "      <td>hays.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>244733</th>\n",
       "      <td>72703372</td>\n",
       "      <td>Project Officer  Rural Development</td>\n",
       "      <td>Project Officer  Rural Development, Omagh Hays...</td>\n",
       "      <td>Omagh</td>\n",
       "      <td>Omagh</td>\n",
       "      <td>NaN</td>\n",
       "      <td>contract</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Other/General Jobs</td>\n",
       "      <td>15000 - 16000</td>\n",
       "      <td>15500</td>\n",
       "      <td>hays.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>244734</th>\n",
       "      <td>72703373</td>\n",
       "      <td>Procurement Officer</td>\n",
       "      <td>Hays Procurement Supply Chain are assisting a ...</td>\n",
       "      <td>Bath</td>\n",
       "      <td>Bath</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Other/General Jobs</td>\n",
       "      <td>22,000-25,000</td>\n",
       "      <td>23500</td>\n",
       "      <td>hays.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>244735</th>\n",
       "      <td>72703374</td>\n",
       "      <td>Social Worker  Sensory Impairment</td>\n",
       "      <td>EXPERIENCED QUALIFIED SOCIAL WORKER REQUIRED F...</td>\n",
       "      <td>Selby but covering Northern Region</td>\n",
       "      <td>UK</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Other/General Jobs</td>\n",
       "      <td>39,330</td>\n",
       "      <td>39330</td>\n",
       "      <td>hays.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>244736</th>\n",
       "      <td>72703379</td>\n",
       "      <td>Management Accountant ( 6 Months )</td>\n",
       "      <td>Management Accountant ( 6 months ) ****k Our c...</td>\n",
       "      <td>Belfast City</td>\n",
       "      <td>UK</td>\n",
       "      <td>NaN</td>\n",
       "      <td>contract</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Other/General Jobs</td>\n",
       "      <td>30000</td>\n",
       "      <td>30000</td>\n",
       "      <td>hays.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>244737</th>\n",
       "      <td>72703380</td>\n",
       "      <td>Social Worker  Childrens Safeguarding Team</td>\n",
       "      <td>Child Protection Social Worker Job ThreeMonth ...</td>\n",
       "      <td>York</td>\n",
       "      <td>York</td>\n",
       "      <td>NaN</td>\n",
       "      <td>contract</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Other/General Jobs</td>\n",
       "      <td>21.00 - 24.00/hour</td>\n",
       "      <td>43200</td>\n",
       "      <td>hays.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>244738</th>\n",
       "      <td>72703385</td>\n",
       "      <td>Payroller</td>\n",
       "      <td>NEED PAYROLLERS WITH ESR WHO HAVE WORKED AT PR...</td>\n",
       "      <td>London</td>\n",
       "      <td>London</td>\n",
       "      <td>NaN</td>\n",
       "      <td>contract</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Other/General Jobs</td>\n",
       "      <td>28,000</td>\n",
       "      <td>28000</td>\n",
       "      <td>hays.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>244739</th>\n",
       "      <td>72703387</td>\n",
       "      <td>Commercial Account Manager</td>\n",
       "      <td>Commercial Account Manager Role An opportunity...</td>\n",
       "      <td>London</td>\n",
       "      <td>London</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Other/General Jobs</td>\n",
       "      <td>47,000 - 65,000</td>\n",
       "      <td>56000</td>\n",
       "      <td>hays.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>244741</th>\n",
       "      <td>72703407</td>\n",
       "      <td>HR Ops Manager (North Region)</td>\n",
       "      <td>My retail client are currently recruiting for ...</td>\n",
       "      <td>Manchester</td>\n",
       "      <td>Manchester</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Scientific &amp; QA Jobs</td>\n",
       "      <td>35,000 - 42,000 DOE</td>\n",
       "      <td>38500</td>\n",
       "      <td>hays.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>244742</th>\n",
       "      <td>72703410</td>\n",
       "      <td>Legal Cashier</td>\n",
       "      <td>LEGAL CASHIER JOB. A top Legal firm based in C...</td>\n",
       "      <td>London</td>\n",
       "      <td>London</td>\n",
       "      <td>NaN</td>\n",
       "      <td>contract</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Legal Jobs</td>\n",
       "      <td>18- 20 per hour</td>\n",
       "      <td>36480</td>\n",
       "      <td>hays.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>244743</th>\n",
       "      <td>72703415</td>\n",
       "      <td>Postroom Operator</td>\n",
       "      <td>A prestigious chambers (Law firm) in the City ...</td>\n",
       "      <td>Temple</td>\n",
       "      <td>Temple</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Legal Jobs</td>\n",
       "      <td>19,000</td>\n",
       "      <td>19000</td>\n",
       "      <td>hays.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>244745</th>\n",
       "      <td>72703429</td>\n",
       "      <td>Salaried General Practitioners</td>\n",
       "      <td>Full and parttime opportunities available With...</td>\n",
       "      <td>Hampshire-wide</td>\n",
       "      <td>UK</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Care UK</td>\n",
       "      <td>Healthcare &amp; Nursing Jobs</td>\n",
       "      <td>up to 100k pa plus MDU plus relocation negotiable</td>\n",
       "      <td>100000</td>\n",
       "      <td>jobs.gponline.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>244751</th>\n",
       "      <td>72703748</td>\n",
       "      <td>Data Architect</td>\n",
       "      <td>A vibrant charitable institute based in Kensin...</td>\n",
       "      <td>London</td>\n",
       "      <td>London</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Charity &amp; Voluntary Jobs</td>\n",
       "      <td>Up to 40k</td>\n",
       "      <td>40000</td>\n",
       "      <td>hays.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>244752</th>\n",
       "      <td>72705197</td>\n",
       "      <td>Curriculum Leader  Mathematics</td>\n",
       "      <td>Curriculum Leader Mathematics TLR 1 **** Requi...</td>\n",
       "      <td>Wrexham</td>\n",
       "      <td>Wrexham</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Teaching Jobs</td>\n",
       "      <td>MPS plus TLR 1 9,013</td>\n",
       "      <td>5006</td>\n",
       "      <td>hays.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>244753</th>\n",
       "      <td>72705199</td>\n",
       "      <td>TEACHER OF MATHS</td>\n",
       "      <td>Position: Qualified Teacher Subject/Specialism...</td>\n",
       "      <td>Wiltshire</td>\n",
       "      <td>Wiltshire</td>\n",
       "      <td>NaN</td>\n",
       "      <td>contract</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Teaching Jobs</td>\n",
       "      <td>450 to $500 per week</td>\n",
       "      <td>22800</td>\n",
       "      <td>hays.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>244754</th>\n",
       "      <td>72705200</td>\n",
       "      <td>Marketing Officer Job</td>\n",
       "      <td>Marketing Officer Job Use a broad range of Mar...</td>\n",
       "      <td>Southampton</td>\n",
       "      <td>Southampton</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Teaching Jobs</td>\n",
       "      <td>27,000 - 33,000 DoE plus attractive benefits</td>\n",
       "      <td>30000</td>\n",
       "      <td>hays.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>244755</th>\n",
       "      <td>72705201</td>\n",
       "      <td>ENGLISH TEACHER</td>\n",
       "      <td>Position: Qualified Teacher Subject/Specialism...</td>\n",
       "      <td>Wiltshire</td>\n",
       "      <td>Wiltshire</td>\n",
       "      <td>NaN</td>\n",
       "      <td>contract</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Teaching Jobs</td>\n",
       "      <td>450 to 500 per week</td>\n",
       "      <td>22800</td>\n",
       "      <td>hays.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>244756</th>\n",
       "      <td>72705202</td>\n",
       "      <td>COVER SUPERVISOR</td>\n",
       "      <td>Position: Cover Supervisor Subject/Specialism:...</td>\n",
       "      <td>Wiltshire</td>\n",
       "      <td>Wiltshire</td>\n",
       "      <td>NaN</td>\n",
       "      <td>contract</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Teaching Jobs</td>\n",
       "      <td>300 to 350 per week</td>\n",
       "      <td>15600</td>\n",
       "      <td>hays.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>244757</th>\n",
       "      <td>72705203</td>\n",
       "      <td>TEACHER OF BUSINESS STUDIES AND LAW</td>\n",
       "      <td>Position: Qualified Teacher Subject/Specialism...</td>\n",
       "      <td>Salisbury</td>\n",
       "      <td>Salisbury</td>\n",
       "      <td>NaN</td>\n",
       "      <td>contract</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Teaching Jobs</td>\n",
       "      <td>450 to 500 per week</td>\n",
       "      <td>22800</td>\n",
       "      <td>hays.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>244758</th>\n",
       "      <td>72705204</td>\n",
       "      <td>SUPPLY TEACHERS</td>\n",
       "      <td>Position: Qualified Teacher Subject/Specialism...</td>\n",
       "      <td>Salisbury</td>\n",
       "      <td>Salisbury</td>\n",
       "      <td>NaN</td>\n",
       "      <td>contract</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Teaching Jobs</td>\n",
       "      <td>450 to 500 per week</td>\n",
       "      <td>22800</td>\n",
       "      <td>hays.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>244759</th>\n",
       "      <td>72705205</td>\n",
       "      <td>TEACHER OF BUSINESS STUDIES AND ICT</td>\n",
       "      <td>Position: Qualified Teacher Subject/Specialism...</td>\n",
       "      <td>Swindon</td>\n",
       "      <td>Swindon</td>\n",
       "      <td>NaN</td>\n",
       "      <td>contract</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Teaching Jobs</td>\n",
       "      <td>450 - 500 per week</td>\n",
       "      <td>22800</td>\n",
       "      <td>hays.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>244760</th>\n",
       "      <td>72705207</td>\n",
       "      <td>HISTORY TEACHER</td>\n",
       "      <td>Position: Teacher Subject/Specialism: History ...</td>\n",
       "      <td>Swindon</td>\n",
       "      <td>Swindon</td>\n",
       "      <td>NaN</td>\n",
       "      <td>contract</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Teaching Jobs</td>\n",
       "      <td>450 to 500 per week</td>\n",
       "      <td>22800</td>\n",
       "      <td>hays.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>244761</th>\n",
       "      <td>72705208</td>\n",
       "      <td>TEACHER OF SCIENCE</td>\n",
       "      <td>Position: Qualified Teacher Subject/Specialism...</td>\n",
       "      <td>Swindon</td>\n",
       "      <td>Swindon</td>\n",
       "      <td>NaN</td>\n",
       "      <td>contract</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Teaching Jobs</td>\n",
       "      <td>450 to 500 per week</td>\n",
       "      <td>22800</td>\n",
       "      <td>hays.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>244762</th>\n",
       "      <td>72705209</td>\n",
       "      <td>TEACHER OF ENGLISH</td>\n",
       "      <td>Position: Qualified Teacher Subject/Specialism...</td>\n",
       "      <td>Swindon</td>\n",
       "      <td>Swindon</td>\n",
       "      <td>NaN</td>\n",
       "      <td>contract</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Teaching Jobs</td>\n",
       "      <td>450 to 500 per week</td>\n",
       "      <td>22800</td>\n",
       "      <td>hays.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>244763</th>\n",
       "      <td>72705211</td>\n",
       "      <td>TEACHER OF SCIENCE</td>\n",
       "      <td>Position: Qualified Teacher Subject/Specialism...</td>\n",
       "      <td>Swindon</td>\n",
       "      <td>Swindon</td>\n",
       "      <td>NaN</td>\n",
       "      <td>contract</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Teaching Jobs</td>\n",
       "      <td>450 - 500 per week</td>\n",
       "      <td>22800</td>\n",
       "      <td>hays.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>244764</th>\n",
       "      <td>72705212</td>\n",
       "      <td>TEACHER OF BUSINESS STUDIES AND ICT</td>\n",
       "      <td>Position: Qualified Teacher or NQT Subject/Spe...</td>\n",
       "      <td>Swindon</td>\n",
       "      <td>Swindon</td>\n",
       "      <td>NaN</td>\n",
       "      <td>contract</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Teaching Jobs</td>\n",
       "      <td>450 - 500 per week</td>\n",
       "      <td>22800</td>\n",
       "      <td>hays.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>244765</th>\n",
       "      <td>72705213</td>\n",
       "      <td>ENGLISH TEACHER</td>\n",
       "      <td>Position: Qualified Teacher Subject/Specialism...</td>\n",
       "      <td>Swindon</td>\n",
       "      <td>Swindon</td>\n",
       "      <td>NaN</td>\n",
       "      <td>contract</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Teaching Jobs</td>\n",
       "      <td>450 - 500 per week</td>\n",
       "      <td>22800</td>\n",
       "      <td>hays.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>244766</th>\n",
       "      <td>72705216</td>\n",
       "      <td>SUPPLY TEACHERS</td>\n",
       "      <td>Position: Qualified Teacher Subject/Specialism...</td>\n",
       "      <td>Wiltshire</td>\n",
       "      <td>Wiltshire</td>\n",
       "      <td>NaN</td>\n",
       "      <td>contract</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Teaching Jobs</td>\n",
       "      <td>450 to 500 per week</td>\n",
       "      <td>22800</td>\n",
       "      <td>hays.co.uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>244767</th>\n",
       "      <td>72705235</td>\n",
       "      <td>Accountant</td>\n",
       "      <td>This entrepreneurial and growing private equit...</td>\n",
       "      <td>Hitchin</td>\n",
       "      <td>Hitchin</td>\n",
       "      <td>NaN</td>\n",
       "      <td>permanent</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Teaching Jobs</td>\n",
       "      <td>40-45,000</td>\n",
       "      <td>42500</td>\n",
       "      <td>hays.co.uk</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>208970 rows × 12 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "              Id                                              Title  \\\n",
       "0       12612628                        Engineering Systems Analyst   \n",
       "1       12612830                            Stress Engineer Glasgow   \n",
       "2       12612844                   Modelling and simulation analyst   \n",
       "3       12613049  Engineering Systems Analyst / Mathematical Mod...   \n",
       "4       12613647         Pioneer, Miser Engineering Systems Analyst   \n",
       "5       13179816         Engineering Systems Analyst Water Industry   \n",
       "6       14131336          Senior Subsea Pipeline Integrity Engineer   \n",
       "7       14663196  RECRUITMENT CONSULTANT  INDUSTRIAL / COMMERCIA...   \n",
       "8       14663197  RECRUITMENT CONSULTANT  CONSTRUCTION / TECHNIC...   \n",
       "9       15395797                             Subsea Cables Engineer   \n",
       "10      19047429            Trainee Mortgage Advisor  East Midlands   \n",
       "11      20199757                   PROJECT ENGINEER, PHARMACEUTICAL   \n",
       "12      20638787                Principal Composite Stress Engineer   \n",
       "13      20638788           Senior Fatigue Damage Tolerance Engineer   \n",
       "14      20797143  Chef de Partie  Award Winning Restaurant  Exce...   \n",
       "15      22579462                                   Quality Engineer   \n",
       "16      22581547                        Principal Controls Engineer   \n",
       "17      22933091  Chef de Partie  Award Winning Dining  Live In ...   \n",
       "18      23528672       Senior Fatigue and Damage Tolerance Engineer   \n",
       "19      23529949                                C I Design Engineer   \n",
       "20      23530231                            Lead Engineers (Stress)   \n",
       "21      24104334    Relief Chef de Partie  Croydon, Surrey  Live in   \n",
       "22      24835524        Senior Control and Instrumentation Engineer   \n",
       "23      24835548               Control and Instrumentation Engineer   \n",
       "24      24854800                          Electrical / ICA Engineer   \n",
       "25      25337172  Pastry Chef for **** red star **** rosette hot...   \n",
       "26      25434785                            Senior Process Engineer   \n",
       "27      25452606  CHEF DE PARTIE POSITION IN **** ROSETTE HOTEL ...   \n",
       "28      25452680  Senior Sous Chef for **** rosette kitchen, up ...   \n",
       "29      25556432  General Manager  Funky, Cool Restaurant Concep...   \n",
       "...          ...                                                ...   \n",
       "244731  72703369            Senior Practitioner Children's Services   \n",
       "244732  72703370                                    Housing Manager   \n",
       "244733  72703372                 Project Officer  Rural Development   \n",
       "244734  72703373                                Procurement Officer   \n",
       "244735  72703374                  Social Worker  Sensory Impairment   \n",
       "244736  72703379                 Management Accountant ( 6 Months )   \n",
       "244737  72703380         Social Worker  Childrens Safeguarding Team   \n",
       "244738  72703385                                          Payroller   \n",
       "244739  72703387                         Commercial Account Manager   \n",
       "244741  72703407                      HR Ops Manager (North Region)   \n",
       "244742  72703410                                      Legal Cashier   \n",
       "244743  72703415                                  Postroom Operator   \n",
       "244745  72703429                     Salaried General Practitioners   \n",
       "244751  72703748                                     Data Architect   \n",
       "244752  72705197                     Curriculum Leader  Mathematics   \n",
       "244753  72705199                                   TEACHER OF MATHS   \n",
       "244754  72705200                              Marketing Officer Job   \n",
       "244755  72705201                                    ENGLISH TEACHER   \n",
       "244756  72705202                                   COVER SUPERVISOR   \n",
       "244757  72705203                TEACHER OF BUSINESS STUDIES AND LAW   \n",
       "244758  72705204                                    SUPPLY TEACHERS   \n",
       "244759  72705205                TEACHER OF BUSINESS STUDIES AND ICT   \n",
       "244760  72705207                                    HISTORY TEACHER   \n",
       "244761  72705208                                 TEACHER OF SCIENCE   \n",
       "244762  72705209                                 TEACHER OF ENGLISH   \n",
       "244763  72705211                                 TEACHER OF SCIENCE   \n",
       "244764  72705212                TEACHER OF BUSINESS STUDIES AND ICT   \n",
       "244765  72705213                                    ENGLISH TEACHER   \n",
       "244766  72705216                                    SUPPLY TEACHERS   \n",
       "244767  72705235                                         Accountant   \n",
       "\n",
       "                                          FullDescription  \\\n",
       "0       Engineering Systems Analyst Dorking Surrey Sal...   \n",
       "1       Stress Engineer Glasgow Salary **** to **** We...   \n",
       "2       Mathematical Modeller / Simulation Analyst / O...   \n",
       "3       Engineering Systems Analyst / Mathematical Mod...   \n",
       "4       Pioneer, Miser  Engineering Systems Analyst Do...   \n",
       "5       Engineering Systems Analyst Water Industry Loc...   \n",
       "6       A globally renowned engineering and training c...   \n",
       "7       THIS IS A LIVE VACANCY NOT A GENERIC ADVERTISE...   \n",
       "8       This is an exceptional opportunity to join a c...   \n",
       "9       A subsea engineering company is looking for an...   \n",
       "10      Are you a successful, results driven person? A...   \n",
       "11      PROJECT ENGINEER PHAMACEUTICAL, c****  Excelle...   \n",
       "12      Aerospace Senior Composite Structures Engineer...   \n",
       "13      Senior Fatigue Static stress (metallic or comp...   \n",
       "14      A well respected restaurant located in the Der...   \n",
       "15      Our client are a leading supplier of precision...   \n",
       "16      A leading Subsea Engineering Company require a...   \n",
       "17      A popular hotel located in Norfolk which is a ...   \n",
       "18      Senior Fatigue Static stress (metallic or comp...   \n",
       "19      We are currently recruiting on behalf of our c...   \n",
       "20      Lead Engineers (Stress) Our client provide hig...   \n",
       "21       HOTEL AND CONFERENCE VENUE CHAIN  RELIEF CHEF...   \n",
       "22      Senior Control and Instrumentation Engineer . ...   \n",
       "23      Control and Instrumentation Engineer / C Readi...   \n",
       "24      Electrical / ICA Engineer Industry: Environmen...   \n",
       "25      Pastry Chef for **** red star **** rosette hot...   \n",
       "26      Senior Process Engineer We are seeking applica...   \n",
       "27      CHEF DE PARTIE POSITION IN **** ROSETTE HOTEL ...   \n",
       "28      Senior Sous Chef for **** rosette kitchen, up ...   \n",
       "29      Senior General Manager – Funky, Cool, Casual R...   \n",
       "...                                                   ...   \n",
       "244731  Senior Practitioner Children s Social Care An ...   \n",
       "244732  Housing Manager Coordinating, influencing and ...   \n",
       "244733  Project Officer  Rural Development, Omagh Hays...   \n",
       "244734  Hays Procurement Supply Chain are assisting a ...   \n",
       "244735  EXPERIENCED QUALIFIED SOCIAL WORKER REQUIRED F...   \n",
       "244736  Management Accountant ( 6 months ) ****k Our c...   \n",
       "244737  Child Protection Social Worker Job ThreeMonth ...   \n",
       "244738  NEED PAYROLLERS WITH ESR WHO HAVE WORKED AT PR...   \n",
       "244739  Commercial Account Manager Role An opportunity...   \n",
       "244741  My retail client are currently recruiting for ...   \n",
       "244742  LEGAL CASHIER JOB. A top Legal firm based in C...   \n",
       "244743  A prestigious chambers (Law firm) in the City ...   \n",
       "244745  Full and parttime opportunities available With...   \n",
       "244751  A vibrant charitable institute based in Kensin...   \n",
       "244752  Curriculum Leader Mathematics TLR 1 **** Requi...   \n",
       "244753  Position: Qualified Teacher Subject/Specialism...   \n",
       "244754  Marketing Officer Job Use a broad range of Mar...   \n",
       "244755  Position: Qualified Teacher Subject/Specialism...   \n",
       "244756  Position: Cover Supervisor Subject/Specialism:...   \n",
       "244757  Position: Qualified Teacher Subject/Specialism...   \n",
       "244758  Position: Qualified Teacher Subject/Specialism...   \n",
       "244759  Position: Qualified Teacher Subject/Specialism...   \n",
       "244760  Position: Teacher Subject/Specialism: History ...   \n",
       "244761  Position: Qualified Teacher Subject/Specialism...   \n",
       "244762  Position: Qualified Teacher Subject/Specialism...   \n",
       "244763  Position: Qualified Teacher Subject/Specialism...   \n",
       "244764  Position: Qualified Teacher or NQT Subject/Spe...   \n",
       "244765  Position: Qualified Teacher Subject/Specialism...   \n",
       "244766  Position: Qualified Teacher Subject/Specialism...   \n",
       "244767  This entrepreneurial and growing private equit...   \n",
       "\n",
       "                               LocationRaw  LocationNormalized ContractType  \\\n",
       "0                  Dorking, Surrey, Surrey             Dorking          NaN   \n",
       "1              Glasgow, Scotland, Scotland             Glasgow          NaN   \n",
       "2        Hampshire, South East, South East           Hampshire          NaN   \n",
       "3           Surrey, South East, South East              Surrey          NaN   \n",
       "4           Surrey, South East, South East              Surrey          NaN   \n",
       "5          Dorking, Surrey, Surrey, Surrey             Dorking          NaN   \n",
       "6                        Aberdeen, Borders                  UK          NaN   \n",
       "7           MANCHESTER, Greater Manchester          Manchester          NaN   \n",
       "8                    LEEDS, West Yorkshire               Leeds          NaN   \n",
       "9                             Aberdeen, UK            Aberdeen          NaN   \n",
       "10                           East Midlands       East Midlands          NaN   \n",
       "11                     Witney, Oxfordshire              Witney          NaN   \n",
       "12                        Avon, South West                Avon          NaN   \n",
       "13                        Avon, South West                Avon          NaN   \n",
       "14          Derby Derbyshire East Midlands               Derby          NaN   \n",
       "15                Gateshead, Tyne and Wear           Gateshead          NaN   \n",
       "16                        Kent, South East                Kent          NaN   \n",
       "17                     Norfolk East Anglia                  UK          NaN   \n",
       "18                        Avon, South West                Avon          NaN   \n",
       "19            Wolverhampton, West Midlands       Wolverhampton          NaN   \n",
       "20         Bristol, Avon, South West, Avon                  UK          NaN   \n",
       "21         South Croydon Surrey South East                  UK          NaN   \n",
       "22                   Berkshire, South East           Berkshire          NaN   \n",
       "23                   Berkshire, South East           Berkshire          NaN   \n",
       "24                      Surrey, South East              Surrey          NaN   \n",
       "25                              North East  North East England          NaN   \n",
       "26                   Berkshire, South East           Berkshire          NaN   \n",
       "27               North Yorkshire Yorkshire     North Yorkshire          NaN   \n",
       "28                              North East  North East England          NaN   \n",
       "29           West London London South East          East Sheen          NaN   \n",
       "...                                    ...                 ...          ...   \n",
       "244731                              London              London          NaN   \n",
       "244732                            Paignton            Paignton          NaN   \n",
       "244733                               Omagh               Omagh          NaN   \n",
       "244734                                Bath                Bath          NaN   \n",
       "244735  Selby but covering Northern Region                  UK          NaN   \n",
       "244736                        Belfast City                  UK          NaN   \n",
       "244737                                York                York          NaN   \n",
       "244738                              London              London          NaN   \n",
       "244739                              London              London          NaN   \n",
       "244741                          Manchester          Manchester          NaN   \n",
       "244742                              London              London          NaN   \n",
       "244743                              Temple              Temple          NaN   \n",
       "244745                      Hampshire-wide                  UK          NaN   \n",
       "244751                              London              London          NaN   \n",
       "244752                             Wrexham             Wrexham          NaN   \n",
       "244753                           Wiltshire           Wiltshire          NaN   \n",
       "244754                         Southampton         Southampton          NaN   \n",
       "244755                           Wiltshire           Wiltshire          NaN   \n",
       "244756                           Wiltshire           Wiltshire          NaN   \n",
       "244757                           Salisbury           Salisbury          NaN   \n",
       "244758                           Salisbury           Salisbury          NaN   \n",
       "244759                             Swindon             Swindon          NaN   \n",
       "244760                             Swindon             Swindon          NaN   \n",
       "244761                             Swindon             Swindon          NaN   \n",
       "244762                             Swindon             Swindon          NaN   \n",
       "244763                             Swindon             Swindon          NaN   \n",
       "244764                             Swindon             Swindon          NaN   \n",
       "244765                             Swindon             Swindon          NaN   \n",
       "244766                           Wiltshire           Wiltshire          NaN   \n",
       "244767                             Hitchin             Hitchin          NaN   \n",
       "\n",
       "       ContractTime                       Company  \\\n",
       "0         permanent  Gregory Martin International   \n",
       "1         permanent  Gregory Martin International   \n",
       "2         permanent  Gregory Martin International   \n",
       "3         permanent  Gregory Martin International   \n",
       "4         permanent  Gregory Martin International   \n",
       "5         permanent  Gregory Martin International   \n",
       "6         permanent                 Indigo 21 Ltd   \n",
       "7         permanent         Code Blue Recruitment   \n",
       "8         permanent         Code Blue Recruitment   \n",
       "9         permanent                 Indigo 21 Ltd   \n",
       "10        permanent             Brite Recruitment   \n",
       "11        permanent       MatchBox Recruiting Ltd   \n",
       "12        permanent  Gregory Martin International   \n",
       "13        permanent  Gregory Martin International   \n",
       "14              NaN                  Chef Results   \n",
       "15        permanent            Asset Appointments   \n",
       "16        permanent                 Indigo 21 Ltd   \n",
       "17              NaN                  Chef Results   \n",
       "18        permanent  Gregory Martin International   \n",
       "19        permanent       Rullion Engineering Ltd   \n",
       "20        permanent  Gregory Martin International   \n",
       "21              NaN            Towngate Personnel   \n",
       "22        permanent  Gregory Martin International   \n",
       "23        permanent  Gregory Martin International   \n",
       "24        permanent  Gregory Martin International   \n",
       "25              NaN               Clear Selection   \n",
       "26        permanent  Gregory Martin International   \n",
       "27              NaN               Clear Selection   \n",
       "28              NaN               Clear Selection   \n",
       "29              NaN    Bee Recruitment London Ltd   \n",
       "...             ...                           ...   \n",
       "244731    permanent                           NaN   \n",
       "244732     contract                           NaN   \n",
       "244733     contract                           NaN   \n",
       "244734    permanent                           NaN   \n",
       "244735    permanent                           NaN   \n",
       "244736     contract                           NaN   \n",
       "244737     contract                           NaN   \n",
       "244738     contract                           NaN   \n",
       "244739    permanent                           NaN   \n",
       "244741    permanent                           NaN   \n",
       "244742     contract                           NaN   \n",
       "244743    permanent                           NaN   \n",
       "244745          NaN                       Care UK   \n",
       "244751    permanent                           NaN   \n",
       "244752    permanent                           NaN   \n",
       "244753     contract                           NaN   \n",
       "244754    permanent                           NaN   \n",
       "244755     contract                           NaN   \n",
       "244756     contract                           NaN   \n",
       "244757     contract                           NaN   \n",
       "244758     contract                           NaN   \n",
       "244759     contract                           NaN   \n",
       "244760     contract                           NaN   \n",
       "244761     contract                           NaN   \n",
       "244762     contract                           NaN   \n",
       "244763     contract                           NaN   \n",
       "244764     contract                           NaN   \n",
       "244765     contract                           NaN   \n",
       "244766     contract                           NaN   \n",
       "244767    permanent                           NaN   \n",
       "\n",
       "                           Category  \\\n",
       "0                  Engineering Jobs   \n",
       "1                  Engineering Jobs   \n",
       "2                  Engineering Jobs   \n",
       "3                  Engineering Jobs   \n",
       "4                  Engineering Jobs   \n",
       "5                  Engineering Jobs   \n",
       "6                  Engineering Jobs   \n",
       "7             HR & Recruitment Jobs   \n",
       "8             HR & Recruitment Jobs   \n",
       "9                  Engineering Jobs   \n",
       "10        Accounting & Finance Jobs   \n",
       "11        Healthcare & Nursing Jobs   \n",
       "12               Other/General Jobs   \n",
       "13               Other/General Jobs   \n",
       "14      Hospitality & Catering Jobs   \n",
       "15                 Engineering Jobs   \n",
       "16                 Engineering Jobs   \n",
       "17      Hospitality & Catering Jobs   \n",
       "18                 Engineering Jobs   \n",
       "19                 Engineering Jobs   \n",
       "20                 Engineering Jobs   \n",
       "21      Hospitality & Catering Jobs   \n",
       "22                 Engineering Jobs   \n",
       "23                 Engineering Jobs   \n",
       "24                 Engineering Jobs   \n",
       "25      Hospitality & Catering Jobs   \n",
       "26                 Engineering Jobs   \n",
       "27      Hospitality & Catering Jobs   \n",
       "28      Hospitality & Catering Jobs   \n",
       "29      Hospitality & Catering Jobs   \n",
       "...                             ...   \n",
       "244731           Other/General Jobs   \n",
       "244732           Other/General Jobs   \n",
       "244733           Other/General Jobs   \n",
       "244734           Other/General Jobs   \n",
       "244735           Other/General Jobs   \n",
       "244736           Other/General Jobs   \n",
       "244737           Other/General Jobs   \n",
       "244738           Other/General Jobs   \n",
       "244739           Other/General Jobs   \n",
       "244741         Scientific & QA Jobs   \n",
       "244742                   Legal Jobs   \n",
       "244743                   Legal Jobs   \n",
       "244745    Healthcare & Nursing Jobs   \n",
       "244751     Charity & Voluntary Jobs   \n",
       "244752                Teaching Jobs   \n",
       "244753                Teaching Jobs   \n",
       "244754                Teaching Jobs   \n",
       "244755                Teaching Jobs   \n",
       "244756                Teaching Jobs   \n",
       "244757                Teaching Jobs   \n",
       "244758                Teaching Jobs   \n",
       "244759                Teaching Jobs   \n",
       "244760                Teaching Jobs   \n",
       "244761                Teaching Jobs   \n",
       "244762                Teaching Jobs   \n",
       "244763                Teaching Jobs   \n",
       "244764                Teaching Jobs   \n",
       "244765                Teaching Jobs   \n",
       "244766                Teaching Jobs   \n",
       "244767                Teaching Jobs   \n",
       "\n",
       "                                                SalaryRaw  SalaryNormalized  \\\n",
       "0                              20000 - 30000/annum 20-30K             25000   \n",
       "1                              25000 - 35000/annum 25-35K             30000   \n",
       "2                              20000 - 40000/annum 20-40K             30000   \n",
       "3                  25000 - 30000/annum 25K-30K negotiable             27500   \n",
       "4                              20000 - 30000/annum 20-30K             25000   \n",
       "5                          20000 - 30000/annum 20K to 30K             25000   \n",
       "6                                    50000 - 100000/annum             75000   \n",
       "7          18000 - 26000/annum TO 26K BASIC + COMM + BENS             22000   \n",
       "8        18000 - 28000/annum 18 - 28K BASIC + COMM + BENS             23000   \n",
       "9                                    70000 - 100000/annum             85000   \n",
       "10                  17000 - 25000/annum 17k - 20k OTE 25k             21000   \n",
       "11        35000 - 40000/annum c40000 + Excellent Benefits             37500   \n",
       "12                            40000 - 50000/annum 40K-50K             45000   \n",
       "13                            35000 - 45000/annum 35K-45K             40000   \n",
       "14        Upto 16,000 per annum + Tips (IRO 3K Per Annum)             16000   \n",
       "15                                            22000/annum             22000   \n",
       "16                                   70000 - 100000/annum             85000   \n",
       "17            18,000 per annum + Tips (IRO 120 Per Month)             18000   \n",
       "18                             34000 - 45000/annum to 45K             39500   \n",
       "19                         33000 - 34000/annum + benefits             33500   \n",
       "20                                    34000 - 45000/annum             39500   \n",
       "21                                        Upto 9 per hour             17280   \n",
       "22                            36000 - 47000/annum 36K-47K             41500   \n",
       "23                            28000 - 35000/annum 28K-35K             31500   \n",
       "24                   28000 - 37000/annum 28,000 to 37,000             32500   \n",
       "25                                        24000 per annum             24000   \n",
       "26                             36000 - 47000/annum 36-47K             41500   \n",
       "27                              16000 per annum + Live In             16000   \n",
       "28                                        26000 per annum             26000   \n",
       "29                        From 28,000 to 35,000 per annum             31500   \n",
       "...                                                   ...               ...   \n",
       "244731                                    33,510 - 39,789             36649   \n",
       "244732  16.50 per hour depending on skills and experience             31680   \n",
       "244733                                      15000 - 16000             15500   \n",
       "244734                                      22,000-25,000             23500   \n",
       "244735                                             39,330             39330   \n",
       "244736                                              30000             30000   \n",
       "244737                                 21.00 - 24.00/hour             43200   \n",
       "244738                                             28,000             28000   \n",
       "244739                                    47,000 - 65,000             56000   \n",
       "244741                                35,000 - 42,000 DOE             38500   \n",
       "244742                                    18- 20 per hour             36480   \n",
       "244743                                             19,000             19000   \n",
       "244745  up to 100k pa plus MDU plus relocation negotiable            100000   \n",
       "244751                                          Up to 40k             40000   \n",
       "244752                               MPS plus TLR 1 9,013              5006   \n",
       "244753                               450 to $500 per week             22800   \n",
       "244754       27,000 - 33,000 DoE plus attractive benefits             30000   \n",
       "244755                                450 to 500 per week             22800   \n",
       "244756                                300 to 350 per week             15600   \n",
       "244757                                450 to 500 per week             22800   \n",
       "244758                                450 to 500 per week             22800   \n",
       "244759                                 450 - 500 per week             22800   \n",
       "244760                                450 to 500 per week             22800   \n",
       "244761                                450 to 500 per week             22800   \n",
       "244762                                450 to 500 per week             22800   \n",
       "244763                                 450 - 500 per week             22800   \n",
       "244764                                 450 - 500 per week             22800   \n",
       "244765                                 450 - 500 per week             22800   \n",
       "244766                                450 to 500 per week             22800   \n",
       "244767                                          40-45,000             42500   \n",
       "\n",
       "               SourceName  \n",
       "0        cv-library.co.uk  \n",
       "1        cv-library.co.uk  \n",
       "2        cv-library.co.uk  \n",
       "3        cv-library.co.uk  \n",
       "4        cv-library.co.uk  \n",
       "5        cv-library.co.uk  \n",
       "6        cv-library.co.uk  \n",
       "7        cv-library.co.uk  \n",
       "8        cv-library.co.uk  \n",
       "9        cv-library.co.uk  \n",
       "10       cv-library.co.uk  \n",
       "11       cv-library.co.uk  \n",
       "12       cv-library.co.uk  \n",
       "13       cv-library.co.uk  \n",
       "14            caterer.com  \n",
       "15       cv-library.co.uk  \n",
       "16       cv-library.co.uk  \n",
       "17            caterer.com  \n",
       "18       cv-library.co.uk  \n",
       "19       cv-library.co.uk  \n",
       "20       cv-library.co.uk  \n",
       "21            caterer.com  \n",
       "22       cv-library.co.uk  \n",
       "23       cv-library.co.uk  \n",
       "24       cv-library.co.uk  \n",
       "25            caterer.com  \n",
       "26       cv-library.co.uk  \n",
       "27            caterer.com  \n",
       "28            caterer.com  \n",
       "29            caterer.com  \n",
       "...                   ...  \n",
       "244731         hays.co.uk  \n",
       "244732         hays.co.uk  \n",
       "244733         hays.co.uk  \n",
       "244734         hays.co.uk  \n",
       "244735         hays.co.uk  \n",
       "244736         hays.co.uk  \n",
       "244737         hays.co.uk  \n",
       "244738         hays.co.uk  \n",
       "244739         hays.co.uk  \n",
       "244741         hays.co.uk  \n",
       "244742         hays.co.uk  \n",
       "244743         hays.co.uk  \n",
       "244745  jobs.gponline.com  \n",
       "244751         hays.co.uk  \n",
       "244752         hays.co.uk  \n",
       "244753         hays.co.uk  \n",
       "244754         hays.co.uk  \n",
       "244755         hays.co.uk  \n",
       "244756         hays.co.uk  \n",
       "244757         hays.co.uk  \n",
       "244758         hays.co.uk  \n",
       "244759         hays.co.uk  \n",
       "244760         hays.co.uk  \n",
       "244761         hays.co.uk  \n",
       "244762         hays.co.uk  \n",
       "244763         hays.co.uk  \n",
       "244764         hays.co.uk  \n",
       "244765         hays.co.uk  \n",
       "244766         hays.co.uk  \n",
       "244767         hays.co.uk  \n",
       "\n",
       "[208970 rows x 12 columns]"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train[train.isnull().any(axis=1)]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We found that there are a lot null in 'contracttype' column, but we know if the contract time is permanent, so we will not use this column in building model. And we fill the missing value with null"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {
    "scrolled": false
   },
   "outputs": [],
   "source": [
    "train=train.fillna('null')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### c)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "From the question, we use salarynormalized as our dependent variable, and we take location normalized, category, sourcename, title,contracttime, and company as independent variable. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [],
   "source": [
    "traindata=train[['LocationNormalized','ContractTime','Company','Category','SourceName']]\n",
    "name=traindata.columns\n",
    "testdata=test[name]\n",
    "Y=train['SalaryNormalized']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 244768 entries, 0 to 244767\n",
      "Data columns (total 5 columns):\n",
      "LocationNormalized    244768 non-null object\n",
      "ContractTime          244768 non-null object\n",
      "Company               244768 non-null object\n",
      "Category              244768 non-null object\n",
      "SourceName            244768 non-null object\n",
      "dtypes: object(5)\n",
      "memory usage: 9.3+ MB\n"
     ]
    }
   ],
   "source": [
    "traindata.info(verbose=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [],
   "source": [
    "testdata=testdata.fillna('null')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 122463 entries, 0 to 122462\n",
      "Data columns (total 5 columns):\n",
      "LocationNormalized    122463 non-null object\n",
      "ContractTime          122463 non-null object\n",
      "Company               122463 non-null object\n",
      "Category              122463 non-null object\n",
      "SourceName            122463 non-null object\n",
      "dtypes: object(5)\n",
      "memory usage: 4.7+ MB\n"
     ]
    }
   ],
   "source": [
    "testdata.info(verbose=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn import preprocessing\n",
    "combine=pd.concat([traindata, testdata], ignore_index=True)\n",
    "data1 = preprocessing.LabelEncoder()\n",
    "newdata1 = combine.apply(data1.fit_transform)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "metadata": {},
   "outputs": [],
   "source": [
    "trains = LabelEncoder()\n",
    "trains= traindata.apply(trains.fit_transform)\n",
    "tests = LabelEncoder()\n",
    "tests= testdata.apply(tests.fit_transform)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "244768 244768 122463 122463\n"
     ]
    }
   ],
   "source": [
    "X, Test = newdata1.iloc[:len(traindata), :], newdata1.iloc[len(traindata):, :] \n",
    "print(len(X),len(traindata),len(Test),len(testdata))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### d)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "metadata": {},
   "outputs": [],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "import numpy as np\n",
    "from sklearn import datasets, linear_model\n",
    "from sklearn.metrics import mean_squared_error, r2_score"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "metadata": {},
   "outputs": [],
   "source": [
    "# sklearn output\n",
    "# Create linear regression object\n",
    "regr = linear_model.LinearRegression()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "LinearRegression(copy_X=True, fit_intercept=True, n_jobs=1, normalize=False)"
      ]
     },
     "execution_count": 40,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Train the model using the training sets\n",
    "regr.fit(trains, Y)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.01906312810060251"
      ]
     },
     "execution_count": 41,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "regr.score(X,Y)  "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[30458.0213396  32842.10742182 33017.69300564 ... 31772.59663228\n",
      " 30427.13433073 30416.09841301]\n"
     ]
    }
   ],
   "source": [
    "predicted = regr.predict(tests)\n",
    "print (predicted)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### e)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "metadata": {},
   "outputs": [],
   "source": [
    "y_test = pd.read_csv('random_forest_benchmark_test_rev1.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "metadata": {},
   "outputs": [],
   "source": [
    "y_test = y_test['SalaryNormalized']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "122463"
      ]
     },
     "execution_count": 45,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "len(y_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "122463"
      ]
     },
     "execution_count": 46,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "len(predicted)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Variance:0.02727716193276919\n",
      "MAE:9448.306455831222\n",
      "MSE:142131177.80158904\n"
     ]
    }
   ],
   "source": [
    "from sklearn.metrics import explained_variance_score,mean_absolute_error,mean_squared_error\n",
    "print(\"Variance:\" +str(explained_variance_score(y_test, predicted)))\n",
    "print(\"MAE:\" +str(mean_absolute_error(y_test, predicted)))\n",
    "print(\"MSE:\" +str(mean_squared_error(y_test, predicted)))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### f)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[ 0.03949473  0.01961345 -0.05378005  0.02036121  0.03225456  0.03742108\n",
      "  0.02225971  0.01150973 -0.00060906 -0.01840015]\n",
      "0.011012520210789334\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[Parallel(n_jobs=1)]: Done  10 out of  10 | elapsed:    0.4s finished\n"
     ]
    }
   ],
   "source": [
    "# evaluate the model using 10-fold cross-validation\n",
    "from sklearn import cross_validation, linear_model\n",
    "import numpy as np\n",
    "regr = linear_model.LinearRegression()\n",
    "scores = cross_validation.cross_val_score(regr, X, Y,verbose=1,cv=10)\n",
    "print (scores)\n",
    "print (scores.mean())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
